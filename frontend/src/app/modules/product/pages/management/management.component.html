<div class="bg-white rounded p-20 m-b-20">
    <div class="row">
        <div class="col-sm-8">
            <h4 class="page-title m-0 f-s-18 f-w-600"
                data-bs-toggle="tooltip"
                data-bs-html="true"
                title="<strong>Hello</strong>, <em>world!</em>">
                {{ 'warehouse.product.common.title' | translate }}
            </h4>
        </div>
        <div class="col-sm-4 text-right">
            <div class="d-flex align-items-center justify-content-start justify-content-lg-end">
                <ul class="breadcrumb">
                    <li class="breadcrumb-item"><a class="text-body-color" [routerLink]="['/']">{{ 'labels.dashboard' | translate }}</a></li>
                    <li class="breadcrumb-item">
                        <i-tabler name="circle-filled" class="icon-8"></i-tabler>
                    </li>
                    <li class="breadcrumb-item active">
                        <span class="rounded-sm p-x-8 p-y-4 text-primary bg-light-primary f-s-12 f-w-500">
                            {{ 'warehouse.product.search.title' | translate }}
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<mat-card-content class="p-0 p-b-10">
    <mat-divider></mat-divider>
    <div class="p-t-0 p-b-20 p-r-10 p-l-10 d-lg-flex">
        <button mat-mini-fab color="primary m-t-24 m-r-10" (click)="openDialogCreateDelivery()" class="d-flex">
            <i class="iconify icon-20 d-flex" data-icon="solar:widget-add-linear"></i>
        </button>
        <mat-form-field class="theme-select m-r-10 d-flex m-t-20 input-height-46" appearance="outline" [style.width.px]="160">
            <mat-label>{{ 'labels.autoRefresh' | translate }}</mat-label>
            <mat-icon matPrefix class="m-r-0 p-r-0"><i-tabler name="refresh" class="icon-20 cursor-pointer"></i-tabler></mat-icon>
            <mat-select [value]="presetAutoRefresh" (selectionChange)="onSelectPresetAutoRefreshChange($event)">
                <mat-option *ngFor="let preset of presetAutoRefreshs" [value]="preset">
                    <ng-container *ngIf="preset !== 'customize'">
                        {{ 'labels.autoRefresh' + preset | translate }}
                    </ng-container>
                </mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field [style.width.px]="200" class="theme-select m-r-10 d-flex m-t-20 input-height-46" appearance="outline">
            <mat-label>{{ 'warehouse.common.keyword' | translate }}</mat-label>
            <input type="text"
                   placeholder="{{ 'warehouse.common.keywordPlaceholder' | translate }}"
                   matInput
                   (keyup.enter)="onInputOrderEnter($event)"
                   [(ngModel)]="keyword" />
        </mat-form-field>
        <div class="m-r-10 p-t-12 m-t-24" [innerHTML]="'warehouse.product.search.findCount' | translate: { count: pageLength | number }"></div>
        <button mat-mini-fab color="primary m-t-24" (click)="search()" class="d-flex">
            <i class="iconify icon-20 d-flex" data-icon="solar:refresh-bold"></i>
        </button>
    </div>

    <mat-divider></mat-divider>
    <div class="table-responsive border rounded-4" (scroll)="onScroll($event)">
        <table mat-table [dataSource]="products" [trackBy]="trackById" class="w-100 table-striped table-hover table-default table-orders">
            <!-- Weight Column -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14 fixed-width-column sticky-col-1" [ngClass]="{ 'sticky-box-shadow-right': isTableScrolled }">
                    {{ 'labels.id' | translate }}
                </th>
                <td mat-cell *matCellDef="let element" class="mat-body-1 sticky-col-1" [style.width.px]="100" [ngClass]="{ 'sticky-box-shadow-right': isTableScrolled }">
                    <a class="cursor-pointer text-primary text-truncate" (click)="openDialogDetail(element)" style="max-width: 50px;">
                        {{ element.custom_id }}
                    </a>
                </td>
            </ng-container>

            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14 fixed-width-column">
                    {{ 'warehouse.product.common.name' | translate }}
                </th>
                <td mat-cell *matCellDef="let element" class="mat-body-1 text-dark-200" [style.width.px]="100">
                    <div class="d-flex align-items-center gap-6">
                        <div>
                            <h5 class="f-s-15 f-w-700 m-t-4 m-b-0">{{ element.data.name }}</h5>
                            <div class="m-t-3"><i-tabler name="hash" class="icon-12 cursor-pointer"></i-tabler>
                                <span *ngFor="let attribute of element.data.product_attributes">
                                    <span>{{ attribute.name }}</span>,
                                </span>
                            </div>
                        </div>
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="image">
                <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14">
                    {{ 'labels.image' | translate }}
                </th>
                <td mat-cell *matCellDef="let element" class="mat-body-1 fixed-width-column" [style.width.px]="80">
                    <img alt="{{ element.seller_sku }}" width="48" class="rounded cursor-pointer product-image"
                         *ngIf="element.data.variations[0].images[0]"
                         appLazyLoadImage="{{ element.data.variations[0].images[0] }}" (error)="onImageError($event)"
                         (click)="openLightBox(element.data.name, element.data.variations[0].images[0])"/>
                </td>
            </ng-container>

            <ng-container matColumnDef="costPrice">
                <th mat-header-cell *matHeaderCellDef class="f-w-600 mat-subtitle-1 f-s-14 fixed-width-column">
                    {{ 'warehouse.common.costPrice' | translate }}
                </th>
                <td mat-cell *matCellDef="let element" class="mat-body-1" [style.width.px]="150">
                    <mat-form-field [style.width.px]="120" class="input-height-46" appearance="outline">
                        <input matInput [type]="'text'" (change)="onChangeCostPrice($event, element)" [ngModel]="element?.cost_price | number" (keyup)="onChangeCostPrice($event, element)" />
                    </mat-form-field> â‚«
                    <button mat-flat-button class="m-l-10" color="primary" (click)="onSave($event, element)">{{ 'buttons.save' | translate }}</button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-dark"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
    </div>
    <div class="text-center p-t-20 p-b-20" *ngIf="products.length == 0">
        <div class="text-muted">{{ 'common.noData' | translate }}</div>
    </div>
    <mat-divider class="m-b-10"></mat-divider>
    <mat-paginator
            [length]="pageLength"
            [pageIndex]="pageIndex"
            [pageSize]="pageSize"
            [pageSizeOptions]="pageSizeOptions"
            (page)="onPageChange($event)"
            aria-label="Select page"></mat-paginator>
</mat-card-content>

