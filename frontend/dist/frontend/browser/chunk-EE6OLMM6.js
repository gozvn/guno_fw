import{a as bi,b as wi}from"./chunk-ZYG6GFSR.js";import{a as Nt}from"./chunk-IAR55NJ4.js";import{b as Ci}from"./chunk-HDVTBRPG.js";import{b as Si,e as xi}from"./chunk-YCX5PDJM.js";import"./chunk-HW6NCLFS.js";import{a as oe,b as yi}from"./chunk-VD7526WH.js";import{r as Oe,s as Z,t as X}from"./chunk-L6F77YVF.js";import{$ as K,A as ui,Aa as he,B as ne,Ba as ye,C as ae,Ca as ve,Da as Se,Ea as ei,F as et,Fa as gi,G as tt,H as z,I as T,J as G,K as Re,N as it,Na as re,O as Te,Pa as xe,Q as ke,Qa as Ue,R as Pe,Ra as Ne,S as Me,Sa as Ce,T as _i,Ta as Ve,U as fi,Ua as je,Va as Fe,W,Wa as Le,X as Be,Xa as Bt,Ya as rt,_ as At,_a as ot,aa as Q,ba as nt,c as Ee,da as at,fb as Ut,gb as hi,ha as Et,ib as J,jb as Y,kb as vi,l as q,lb as k,o as Xe,oa as Rt,pa as Tt,q as Xt,ra as kt,sa as Pt,ta as Mt,ua as de,va as ce,wa as ue,xa as _e,y as ci,ya as fe,za as ge}from"./chunk-72SSQTOY.js";import{Ab as O,Ac as Je,Bc as me,Cc as li,Da as D,Dc as mi,Ea as A,Ec as si,Fb as _,Hc as p,Ic as d,Ja as L,Jb as Zt,Jc as se,K as ri,Kb as c,Kc as ie,Lb as w,Ub as o,Vb as l,Wb as C,Xb as S,Yb as x,_b as R,bc as b,dc as g,gc as E,ha as te,hb as Ge,ia as wt,ib as oi,jc as Ie,jd as pe,kc as De,lc as Ae,ma as j,mb as n,nb as v,nd as Ye,od as $,pc as V,pd as H,qc as s,rc as h,sa as F,sc as f,sd as Dt,ta as It,tc as N,td as pi,u as B,vc as We,wc as Ke,wd as Ze,xc as Qe,xd as di}from"./chunk-7KMJWKAM.js";import"./chunk-WWX6BADO.js";var Vt=class{static MatchPassword(i){i.get("confirmPassword").setErrors(null);let t=i.get("password")?.value??i.get("newPassword")?.value,r=i.get("confirmPassword").value;if(t&&t!=r)i.get("confirmPassword").setErrors({MatchPassword:!0});else return null}};function $e(e){let i=e.value;return/<\/?[^>]+>/.test(i)?{htmlTag:!0}:null}function He(e){return i=>{let t=i.value;return typeof t=="string"&&t.trim()===""&&t.length>=e?{excessWhiteSpace:!0}:null}}var jt=class e{lowerCase=!0;upperCase=!0;numbers=!0;symbols=!0;dictionary=[];chars=["abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPWRSTUVWXYZ","0123456789","!@#$%^&*-"];length=15;constructor(){}generatePassword(i){if(this.lowerCase===!1&&this.upperCase===!1&&this.numbers===!1&&this.symbols===!1)return"...";this.length=typeof i<"u"?i:this.length,this.dictionary=[].concat(this.lowerCase?this.chars[0].split(""):[],this.upperCase?this.chars[1].split(""):[],this.numbers?this.chars[2].split(""):[],this.symbols?this.chars[3].split(""):[]);let t="";for(let r=0;r<this.length;r++)r<this.chars.length?t+=this.chars[r].charAt(Math.floor(this.getRandomValue(this.chars[r].length))):t+=this.dictionary[Math.floor(this.getRandomValue(this.dictionary.length))];return t}getRandomValue(i){let t=new Uint32Array(1);window.crypto.getRandomValues(t);let r=t[0]/4294967296;return Math.floor(r*i)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=te({token:e,factory:e.\u0275fac,providedIn:"root"})};var lt=class{id;username="";email="";avatar="";fullName="";roleId=0;status=0;allow=0;roleName="";createdAt=""};var qe=class e{constructor(i,t){this.http=i;this.backendService=t}apiServerPaths=k.backendServer.paths;_getModel(i){let t=new lt;return t.id=i.id,t.username=i.username,t.email=i.email,t.avatar=i.avatar,t.fullName=i.fullName,t.roleId=i.roleId,t.status=i.status,t.roleName=i.role?i.role.name:null,t.allow=i.allow,t.createdAt=i.createdAt,t}get(i){let t={params:{encryptParam:!0},headers:{Accept:"application/json"}};for(let r in i)t.params[r]=i[r];return this.backendService.get(this.apiServerPaths.administrator.user.list,t,B(r=>{let a=[],m=r.data.users;for(let u in m)a.push(this._getModel(m[u]));return{data:a,count:r.data?.count}}))}create(i,t=!1){let r={email:i.email,first_name:i.firstName,last_name:i.lastName,role_id:i.roleId,status:i.status,password:i.password,confirmPassword:i.confirmPassword,apps:i.domains,phone:i.phone,encryptBody:t};return this.backendService.post(this.apiServerPaths.administrator.user.create,r,B(a=>a))}update(i,t="",r="",a="",m=!1){let u={roleId:i.roleId,status:i.status,fullName:i.fullName,phone:i.phone,encryptBody:m};r&&(u.password=r,u.confirmPassword=a,u.currentPassword=t);let y={body:u},I=this.apiServerPaths.administrator.user.update;return I=I.replace("{USER_ID}",String(i.id)),this.backendService.put(I,y,B(P=>P))}changePassword(i,t="",r="",a="",m=!1){let u={roleId:i.roleId,status:i.status,encryptBody:m};r&&(u.password=r,u.confirmPassword=a,u.currentPassword=t);let y=this.apiServerPaths.administrator.user.changePassword;return y=y.replace("{USER_ID}",String(i.id)),this.backendService.put(y,u,B(I=>I))}setRole(i,t,r=!1){let a=this.apiServerPaths.administrator.user.setRole;a=a.replace("{USER_ID}",String(i));let m={body:{roleId:t,encryptBody:r}};return this.backendService.put(a,m,B(u=>u))}static \u0275fac=function(t){return new(t||e)(j(Ee),j(Oe))};static \u0275prov=te({token:e,factory:e.\u0275fac,providedIn:"root"})};function ki(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.fullName.required")," "))}function Pi(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.fullName.minLength")," "))}function Mi(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.fullName.maxLength")," "))}function Bi(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.excessWhiteSpace")," "))}function Ui(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.htmlTag")," "))}function Ni(e,i){if(e&1&&(o(0,"mat-error"),_(1,ki,3,3,"span",25)(2,Pi,3,3,"span",25)(3,Mi,3,3,"span",25)(4,Bi,3,3,"span",25)(5,Ui,3,3,"span",25),l()),e&2){let t,r,a,m,u,y=g();n(),c("ngIf",(t=y.formUser.get("fullName"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=y.formUser.get("fullName"))==null||r.errors==null?null:r.errors.minlength),n(),c("ngIf",(a=y.formUser.get("fullName"))==null||a.errors==null?null:a.errors.maxlength),n(),c("ngIf",(m=y.formUser.get("fullName"))==null||m.errors==null?null:m.errors.excessWhiteSpace),n(),c("ngIf",(u=y.formUser.get("fullName"))==null||u.errors==null?null:u.errors.htmlTag)}}function Vi(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.email.required")," "))}function ji(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.email.pattern")," "))}function Fi(e,i){if(e&1&&(o(0,"mat-error"),_(1,Vi,3,3,"span",25)(2,ji,3,3,"span",25),l()),e&2){let t,r,a=g();n(),c("ngIf",(t=a.formUser.get("email"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=a.formUser.get("email"))==null||r.errors==null?null:r.errors.pattern)}}function Li(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.password.required")," "))}function Oi(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.password.pattern")," "))}function $i(e,i){if(e&1&&(o(0,"mat-error"),_(1,Li,3,3,"span",25)(2,Oi,3,3,"span",25),l()),e&2){let t,r,a=g();n(),c("ngIf",(t=a.formUser.get("password"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=a.formUser.get("password"))==null||r.errors==null?null:r.errors.pattern)}}function Hi(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.confirmPassword.required")," "))}function qi(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.confirmPassword.notMatch")," "))}function zi(e,i){if(e&1&&(o(0,"mat-error"),_(1,Hi,3,3,"span",25)(2,qi,3,3,"span",25),l()),e&2){let t,r,a=g();n(),c("ngIf",(t=a.formUser.get("confirmPassword"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=a.formUser.get("confirmPassword"))==null||r.errors==null?null:r.errors.MatchPassword)}}function Gi(e,i){if(e&1&&(o(0,"mat-option",27),S(1),s(2),x(),l()),e&2){let t=i.$implicit;c("value",t.id),n(2),f(" ",t.name," ")}}function Wi(e,i){if(e&1&&(o(0,"mat-option",27),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.user.status."+t)," ")}}var Ft=class e extends X{constructor(t,r,a,m,u,y,I,P,U,M){super(t,r,a,m);this.activeRoute=t;this.translateService=r;this.authenticationService=a;this.injector=m;this.dialogRef=u;this.helperService=y;this.data=I;this.userService=P;this.snackBar=U;this.fb=M;this.statuses=this.data.statuses??[],this.roles=this.data.roles??[]}formUser;statusActive=1;defaultRole=3;statuses=[];roles=[];isShowPassword=!1;environment=k;ngOnInit(){super.ngOnInit(),this.initForm()}initForm(){this.formUser=this.fb.group({fullName:["",[T.required,T.minLength(5),T.maxLength(255),$e,He(5)]],status:[this.statusActive,[T.required]],role:[this.defaultRole,[T.required]],email:["",[T.required,T.pattern(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)]],password:["",[T.required,T.pattern(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{6,30}$/)]],confirmPassword:[""]},{validator:Vt.MatchPassword})}openSnackBar(t,r){this.snackBar.open(t,r,{horizontalPosition:"end",verticalPosition:"top",duration:10*1e3})}save(){let t=this.environment.rsa.isActive||!1;this.formUser.valid&&this.userService.create(this.formUser.value,t).subscribe(r=>{if(r.status===1){this.openSnackBar(this.translateService.instant("admin.system.user.notify.createSuccess"),""),this.dialogRef.close(!0);return}this.openSnackBar(this.translateService.instant("admin.system.user.notify.createFailed"),"")})}isValid(){return this.formUser.valid}generatePassword(){let t=this.helperService.generatePassword(12);this.formUser.controls.password.setValue(t),this.formUser.controls.confirmPassword.setValue(t)}static \u0275fac=function(r){return new(r||e)(v(q),v(J),v(Z),v(L),v(Ue),v(jt),v(Ne),v(qe),v(xe),v(Me))};static \u0275cmp=F({type:e,selectors:[["app-admin-dialog-system-create-user"]],features:[O],decls:76,vars:59,consts:[["mat-dialog-title",""],[3,"formGroup"],[1,"row"],[1,"col-sm-12","d-flex","align-items-center"],[1,"f-w-600","d-block","m-b-10"],[1,"col-sm-12"],["appearance","outline",1,"w-100"],["type","text","formControlName","fullName","matInput","",3,"placeholder"],[4,"ngIf"],["type","text","formControlName","email","matInput","",3,"placeholder"],[1,"col-sm-9"],["type","text","formControlName","password","matInput","",3,"placeholder","type"],["mat-icon-button","","matSuffix","",3,"click"],[3,"name"],[1,"col-sm-3","d-flex"],["mat-flat-button","","color","primary",1,"w-100","btn-height-46",3,"click"],["name","reload",1,"icon-20","m-r-6"],["type","text","formControlName","confirmPassword","matInput","",3,"placeholder","type"],[1,"col-md-6","col-sm-12"],["appearance","outline",1,"input-height-46","w-100"],[3,"selectionChange","value"],[3,"value",4,"ngFor","ngForOf"],["align","end",1,"p-r-30","p-b-30"],["mat-stroked-button","","color","warn","mat-dialog-close",""],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click","disabled"],["class","m-b-0",4,"ngIf"],[1,"m-b-0"],[3,"value"]],template:function(r,a){if(r&1&&(o(0,"h2",0),s(1),p(2,"translate"),l(),o(3,"mat-dialog-content")(4,"form",1)(5,"div",2)(6,"div",3)(7,"mat-label",4),s(8),p(9,"translate"),l()(),o(10,"div",5)(11,"mat-form-field",6),C(12,"input",7),p(13,"translate"),_(14,Ni,6,5,"mat-error",8),l()()(),o(15,"div",2)(16,"div",3)(17,"mat-label",4),s(18),p(19,"translate"),l()(),o(20,"div",5)(21,"mat-form-field",6),C(22,"input",9),p(23,"translate"),_(24,Fi,3,2,"mat-error",8),l()()(),o(25,"div",2)(26,"div",3)(27,"mat-label",4),s(28),p(29,"translate"),l()(),o(30,"div",10)(31,"mat-form-field",6),C(32,"input",11),p(33,"translate"),o(34,"button",12),b("click",function(){return a.isShowPassword=!a.isShowPassword}),C(35,"i-tabler",13),l(),_(36,$i,3,2,"mat-error",8),l()(),o(37,"div",14)(38,"button",15),b("click",function(){return a.generatePassword()}),C(39,"i-tabler",16),o(40,"span"),s(41),p(42,"translate"),l()()()(),o(43,"div",2)(44,"div",5)(45,"mat-label",4),s(46),p(47,"translate"),l(),o(48,"mat-form-field",6),C(49,"input",17),p(50,"translate"),o(51,"button",12),b("click",function(){return a.isShowPassword=!a.isShowPassword}),C(52,"i-tabler",13),l(),_(53,zi,3,2,"mat-error",8),l()()(),o(54,"div",2)(55,"div",18)(56,"mat-label",4),s(57),p(58,"translate"),l(),o(59,"mat-form-field",19)(60,"mat-select",20),b("selectionChange",function(u){let y;return(y=a.formUser.get("role"))==null?null:y.setValue(u.value)}),_(61,Gi,3,2,"mat-option",21),l()()(),o(62,"div",18)(63,"mat-label",4),s(64),p(65,"translate"),l(),o(66,"mat-form-field",19)(67,"mat-select",20),b("selectionChange",function(u){let y;return(y=a.formUser.get("status"))==null?null:y.setValue(u.value)}),_(68,Wi,4,4,"mat-option",21),l()()()()()(),o(69,"mat-dialog-actions",22)(70,"button",23),s(71),p(72,"translate"),l(),o(73,"button",24),b("click",function(){return a.save()}),s(74),p(75,"translate"),l()()),r&2){let m,u,y,I,P,U;n(),h(d(2,31,"admin.system.user.createUser")),n(3),c("formGroup",a.formUser),n(4),h(d(9,33,"admin.system.user.fullName")),n(4),E("placeholder",d(13,35,"admin.system.user.placeholder.enterFullName")),n(2),c("ngIf",((m=a.formUser.get("fullName"))==null?null:m.invalid)&&((m=a.formUser.get("fullName"))==null?null:m.touched)),n(4),h(d(19,37,"admin.system.user.email")),n(4),E("placeholder",d(23,39,"admin.system.user.placeholder.enterEmail")),n(2),c("ngIf",((u=a.formUser.get("email"))==null?null:u.invalid)&&((u=a.formUser.get("email"))==null?null:u.touched)),n(4),h(d(29,41,"admin.system.user.password")),n(4),E("placeholder",d(33,43,"admin.system.user.placeholder.enterPassword")),c("type",a.isShowPassword?"password":"text"),n(2),Zt("aria-label","Hide password"),n(),c("name",a.isShowPassword?"eye-closed":"eye"),n(),c("ngIf",((y=a.formUser.get("password"))==null?null:y.invalid)&&((y=a.formUser.get("password"))==null?null:y.touched)),n(5),h(d(42,45,"admin.system.user.generatePassword")),n(5),h(d(47,47,"admin.system.user.confirmPassword")),n(3),E("placeholder",d(50,49,"admin.system.user.placeholder.enterConfirmPassword")),c("type",a.isShowPassword?"password":"text"),n(2),Zt("aria-label","Hide password")("aria-pressed",a.isShowPassword),n(),c("name",a.isShowPassword?"eye-closed":"eye"),n(),c("ngIf",((I=a.formUser.get("confirmPassword"))==null?null:I.invalid)&&((I=a.formUser.get("confirmPassword"))==null?null:I.touched)),n(4),h(d(58,51,"admin.system.user.role")),n(3),c("value",(P=a.formUser.get("role"))==null?null:P.value),n(),c("ngForOf",a.roles),n(3),h(d(65,53,"admin.system.user.status")),n(3),c("value",(U=a.formUser.get("status"))==null?null:U.value),n(),c("ngForOf",a.statuses),n(3),h(d(72,55,"buttons.close")),n(2),c("disabled",!a.isValid()||a.loadingState),n(),h(d(75,57,"buttons.save"))}},dependencies:[$,H,Te,z,G,Re,ke,Pe,ae,tt,Q,K,W,Be,At,re,ne,Ve,je,Le,Fe,oe,Y],styles:[".admin-dialog-system-create-user .mat-mdc-form-field-error-wrapper{padding:0}  .admin-dialog-system-create-user .mdc-button__label{display:flex}"]})};var Ot=class{id="";name="";groupName="";uri="";vendor="";package="";controller="";methods=[];middleware=[];wheres=[];isAllow=!1;constructor(i){i&&(this.id=i.route.id||null,this.name=i.route.name||null,this.groupName=i.route.groupName||null,this.uri=i.route.uri||null,this.vendor=i.route.vendor||null,this.package=i.route.package||null,this.methods=i.route.methods||[],this.controller=i.route.controller||null,this.middleware=i.route.middleware||[],this.wheres=i.route.wheres||null,this.isAllow=i.allow===1)}};var vt=class e{constructor(i,t){this.http=i;this.backendService=t}apiServerPaths=k.backendServer.paths;details(i,t){let r={headers:{Accept:"application/json"},params:{encryptParam:!0}},a=this.apiServerPaths.administrator.permission.details+`/${i}/${t}`;return this.backendService.get(a,r,B(m=>{let u=[],y=[],I=[],P=m.data.routes;for(let ze in P){let we=new Ot(P[ze]);u.push(we),we.isAllow===!0?y.push(we):I.push(we)}let U=[];for(let ze in m.data.modules){let we=m.data.modules[ze];for(let St in we)U.push(ze+" / "+we[St])}let M=m.data.featureFlags;return{data:{routes:{all:u,allow:y,deny:I},extraPermission:m.data.extra_permission,packages:U,featureFlags:M},count:u.length}}))}set(i,t,r,a){let m={routeId:r.id,allow:a,encryptBody:!0},u=this.apiServerPaths.administrator.permission.set+`/${i}/${t}`;return this.backendService.post(u,m,B(y=>y))}setExtraPermissions(i,t,r){let a={extra_permissions:r},m=this.apiServerPaths.administrator.permission.setExtra+`/${i}/${t}`;return this.backendService.post(m,a,B(u=>u))}static \u0275fac=function(t){return new(t||e)(j(Ee),j(Oe))};static \u0275prov=te({token:e,factory:e.\u0275fac,providedIn:"root"})};var Zi=["keyword"],Xi=e=>({name:e});function en(e,i){}function tn(e,i){e&1&&_(0,en,0,0,"ng-template")}function nn(e,i){}function an(e,i){e&1&&_(0,nn,0,0,"ng-template")}function rn(e,i){}function on(e,i){e&1&&_(0,rn,0,0,"ng-template")}function ln(e,i){}function mn(e,i){e&1&&_(0,ln,0,0,"ng-template")}function sn(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.fullName.required")," "))}function pn(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.fullName.minLength")," "))}function dn(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.fullName.maxLength")," "))}function cn(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.excessWhiteSpace")," "))}function un(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.htmlTag")," "))}function _n(e,i){if(e&1&&(o(0,"mat-error"),_(1,sn,3,3,"span",25)(2,pn,3,3,"span",25)(3,dn,3,3,"span",25)(4,cn,3,3,"span",25)(5,un,3,3,"span",25),l()),e&2){let t,r,a,m,u,y=g(2);n(),c("ngIf",(t=y.formUser.get("fullName"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=y.formUser.get("fullName"))==null||r.errors==null?null:r.errors.minlength),n(),c("ngIf",(a=y.formUser.get("fullName"))==null||a.errors==null?null:a.errors.maxlength),n(),c("ngIf",(m=y.formUser.get("fullName"))==null||m.errors==null?null:m.errors.excessWhiteSpace),n(),c("ngIf",(u=y.formUser.get("fullName"))==null||u.errors==null?null:u.errors.htmlTag)}}function fn(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.email.required")," "))}function gn(e,i){e&1&&(o(0,"span",26),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.validatedErrors.email.pattern")," "))}function hn(e,i){if(e&1&&(o(0,"mat-error"),_(1,fn,3,3,"span",25)(2,gn,3,3,"span",25),l()),e&2){let t,r,a=g(2);n(),c("ngIf",(t=a.formUser.get("email"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=a.formUser.get("email"))==null||r.errors==null?null:r.errors.pattern)}}function yn(e,i){if(e&1&&(o(0,"mat-option",27),S(1),s(2),x(),l()),e&2){let t=i.$implicit;c("value",t.id),n(2),f(" ",t.name," ")}}function vn(e,i){if(e&1&&(o(0,"mat-option",27),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.user.status."+t)," ")}}function Sn(e,i){if(e&1){let t=R();o(0,"form",13)(1,"div",14)(2,"div",15)(3,"mat-label",16),s(4),p(5,"translate"),l(),o(6,"mat-form-field",17),C(7,"input",18),p(8,"translate"),_(9,_n,6,5,"mat-error",19),l()(),o(10,"div",15)(11,"mat-label",16),s(12),p(13,"translate"),l(),o(14,"mat-form-field",17),C(15,"input",20),p(16,"translate"),_(17,hn,3,2,"mat-error",19),l()()(),o(18,"div",14)(19,"div",21)(20,"mat-label",16),s(21),p(22,"translate"),l(),o(23,"mat-form-field",22)(24,"mat-select",23),b("selectionChange",function(a){let m;D(t);let u=g();return A((m=u.formUser.get("roleId"))==null?null:m.setValue(a.value))}),_(25,yn,3,2,"mat-option",24),l()()(),o(26,"div",21)(27,"mat-label",16),s(28),p(29,"translate"),l(),o(30,"mat-form-field",22)(31,"mat-select",23),b("selectionChange",function(a){let m;D(t);let u=g();return A((m=u.formUser.get("status"))==null?null:m.setValue(a.value))}),_(32,vn,4,4,"mat-option",24),l()()()()()}if(e&2){let t,r,a,m,u=g();c("formGroup",u.formUser),n(4),f(" ",d(5,13,"admin.system.user.fullName")," "),n(3),E("placeholder",d(8,15,"admin.system.user.placeholder.enterFullName")),n(2),c("ngIf",((t=u.formUser.get("fullName"))==null?null:t.invalid)&&((t=u.formUser.get("fullName"))==null?null:t.touched)),n(3),f(" ",d(13,17,"admin.system.user.email")," "),n(3),E("placeholder",d(16,19,"admin.system.user.placeholder.enterEmail")),n(2),c("ngIf",((r=u.formUser.get("email"))==null?null:r.invalid)&&((r=u.formUser.get("email"))==null?null:r.touched)),n(4),h(d(22,21,"admin.system.user.role")),n(3),c("value",(a=u.formUser.get("roleId"))==null?null:a.value),n(),c("ngForOf",u.roles),n(3),h(d(29,23,"admin.system.user.status")),n(3),c("value",(m=u.formUser.get("status"))==null?null:m.value),n(),c("ngForOf",u.statuses)}}function xn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function Cn(e,i){if(e&1&&(o(0,"td",49)(1,"p",50),s(2),l()()),e&2){let t=i.index,r=g(2);w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function bn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.allowed")," "))}function wn(e,i){if(e&1){let t=R();o(0,"td",49)(1,"mat-slide-toggle",51),b("change",function(a){let m=D(t).$implicit,u=g(2);return A(u.toggle(a,m))}),l()()}if(e&2){let t=i.$implicit;w("width",120,"px"),n(),c("checked",!!t.isAllow)}}function In(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.name")," "))}function Dn(e,i){if(e&1&&(o(0,"td",49)(1,"span",52),s(2),l(),o(3,"ul",26)(4,"li",53),s(5),p(6,"translate"),l(),o(7,"li",53),s(8),p(9,"translate"),l()()()),e&2){let t=i.$implicit;n(2),h(t.name),n(3),N("",d(6,5,"admin.system.permission.controller"),": ",t.controller,""),n(3),N("",d(9,7,"admin.system.permission.middleware"),": ",t.middleware.join(", "),"")}}function An(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.groupName")," "))}function En(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",200,"px"),n(2),h(t.groupName)}}function Rn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.package")," "))}function Tn(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",100,"px"),n(2),N("",t.vendor," / ",t.package,"")}}function kn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.uri")," "))}function Pn(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",250,"px"),n(2),h(t.uri)}}function Mn(e,i){e&1&&C(0,"tr",54)}function Bn(e,i){e&1&&C(0,"tr",55)}function Un(e,i){e&1&&(o(0,"div",56)(1,"div",57),s(2),p(3,"translate"),l()()),e&2&&(n(2),h(d(3,1,"dataNotFound")))}function Nn(e,i){if(e&1){let t=R();o(0,"div",14)(1,"div",28)(2,"div",29)(3,"mat-form-field",30)(4,"input",31,4),p(6,"translate"),b("keydown.enter",function(a){D(t);let m=g();return A(m.filterRoutes(a))}),l()(),o(7,"button",32),b("click",function(a){D(t);let m=g();return A(m.filterRoutes(a))}),C(8,"i-tabler",33),o(9,"span"),s(10),p(11,"translate"),l()()()()(),o(12,"div",34)(13,"table",35),S(14,36),_(15,xn,3,3,"th",37)(16,Cn,3,3,"td",38),x(),S(17,39),_(18,bn,3,3,"th",37)(19,wn,2,3,"td",38),x(),S(20,40),_(21,In,3,3,"th",37)(22,Dn,10,9,"td",41),x(),S(23,42),_(24,An,3,3,"th",37)(25,En,3,3,"td",38),x(),S(26,43),_(27,Rn,3,3,"th",37)(28,Tn,3,4,"td",38),x(),S(29,44),_(30,kn,3,3,"th",37)(31,Pn,3,3,"td",38),x(),_(32,Mn,1,0,"tr",45)(33,Bn,1,0,"tr",46),l()(),_(34,Un,4,3,"div",47)}if(e&2){let t=g();n(3),w("width",400,"px"),n(),E("placeholder",d(6,10,"admin.system.permission.placeholder.enterKeyword")),n(3),w("width",120,"px"),n(3),h(d(11,12,"buttons.search")),n(3),c("dataSource",t.aclAll),n(19),c("matHeaderRowDef",t.displayedColumns),n(),c("matRowDefColumns",t.displayedColumns),n(),c("ngIf",t.aclAll.length==0)}}function Vn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function jn(e,i){if(e&1&&(o(0,"td",49)(1,"p",50),s(2),l()()),e&2){let t=i.index,r=g(2);w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function Fn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.allowed")," "))}function Ln(e,i){if(e&1){let t=R();o(0,"td",49)(1,"mat-slide-toggle",51),b("change",function(a){let m=D(t).$implicit,u=g(2);return A(u.toggle(a,m))}),l()()}if(e&2){let t=i.$implicit;w("width",120,"px"),n(),c("checked",!!t.isAllow)}}function On(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.name")," "))}function $n(e,i){if(e&1&&(o(0,"td",49)(1,"span",52),s(2),l(),o(3,"ul",26)(4,"li",53),s(5),p(6,"translate"),l(),o(7,"li",53),s(8),p(9,"translate"),l()()()),e&2){let t=i.$implicit;n(2),h(t.name),n(3),N("",d(6,5,"admin.system.permission.controller"),": ",t.controller,""),n(3),N("",d(9,7,"admin.system.permission.middleware"),": ",t.middleware.join(", "),"")}}function Hn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.groupName")," "))}function qn(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",200,"px"),n(2),h(t.groupName)}}function zn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.package")," "))}function Gn(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",100,"px"),n(2),N("",t.vendor," / ",t.package,"")}}function Wn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.uri")," "))}function Kn(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",250,"px"),n(2),h(t.uri)}}function Qn(e,i){e&1&&C(0,"tr",54)}function Jn(e,i){e&1&&C(0,"tr",55)}function Yn(e,i){e&1&&(o(0,"div",56)(1,"div",57),s(2),p(3,"translate"),l()()),e&2&&(n(2),h(d(3,1,"dataNotFound")))}function Zn(e,i){if(e&1&&(o(0,"div",34)(1,"table",35),S(2,36),_(3,Vn,3,3,"th",37)(4,jn,3,3,"td",38),x(),S(5,39),_(6,Fn,3,3,"th",37)(7,Ln,2,3,"td",38),x(),S(8,40),_(9,On,3,3,"th",37)(10,$n,10,9,"td",41),x(),S(11,42),_(12,Hn,3,3,"th",37)(13,qn,3,3,"td",38),x(),S(14,43),_(15,zn,3,3,"th",37)(16,Gn,3,4,"td",38),x(),S(17,44),_(18,Wn,3,3,"th",37)(19,Kn,3,3,"td",38),x(),_(20,Qn,1,0,"tr",45)(21,Jn,1,0,"tr",46),l()(),_(22,Yn,4,3,"div",47)),e&2){let t=g();n(),c("dataSource",t.aclAllow),n(19),c("matHeaderRowDef",t.displayedColumns),n(),c("matRowDefColumns",t.displayedColumns),n(),c("ngIf",t.aclAllow.length==0)}}function Xn(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function ea(e,i){if(e&1&&(o(0,"td",49)(1,"p",50),s(2),l()()),e&2){let t=i.index,r=g(2);w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function ta(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.allowed")," "))}function ia(e,i){if(e&1){let t=R();o(0,"td",49)(1,"mat-slide-toggle",51),b("change",function(a){let m=D(t).$implicit,u=g(2);return A(u.toggle(a,m))}),l()()}if(e&2){let t=i.$implicit;w("width",120,"px"),n(),c("checked",!!t.isAllow)}}function na(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.name")," "))}function aa(e,i){if(e&1&&(o(0,"td",49)(1,"span",52),s(2),l(),o(3,"ul",26)(4,"li",53),s(5),p(6,"translate"),l(),o(7,"li",53),s(8),p(9,"translate"),l()()()),e&2){let t=i.$implicit;n(2),h(t.name),n(3),N("",d(6,5,"admin.system.permission.controller"),": ",t.controller,""),n(3),N("",d(9,7,"admin.system.permission.middleware"),": ",t.middleware.join(", "),"")}}function ra(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.groupName")," "))}function oa(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",200,"px"),n(2),h(t.groupName)}}function la(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.package")," "))}function ma(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",100,"px"),n(2),N("",t.vendor," / ",t.package,"")}}function sa(e,i){e&1&&(o(0,"th",48),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.uri")," "))}function pa(e,i){if(e&1&&(o(0,"td",49)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",250,"px"),n(2),h(t.uri)}}function da(e,i){e&1&&C(0,"tr",54)}function ca(e,i){e&1&&C(0,"tr",55)}function ua(e,i){e&1&&(o(0,"div",56)(1,"div",57),s(2),p(3,"translate"),l()()),e&2&&(n(2),h(d(3,1,"dataNotFound")))}function _a(e,i){if(e&1&&(o(0,"div",34)(1,"table",35),S(2,36),_(3,Xn,3,3,"th",37)(4,ea,3,3,"td",38),x(),S(5,39),_(6,ta,3,3,"th",37)(7,ia,2,3,"td",38),x(),S(8,40),_(9,na,3,3,"th",37)(10,aa,10,9,"td",41),x(),S(11,42),_(12,ra,3,3,"th",37)(13,oa,3,3,"td",38),x(),S(14,43),_(15,la,3,3,"th",37)(16,ma,3,4,"td",38),x(),S(17,44),_(18,sa,3,3,"th",37)(19,pa,3,3,"td",38),x(),_(20,da,1,0,"tr",45)(21,ca,1,0,"tr",46),l()(),_(22,ua,4,3,"div",47)),e&2){let t=g();n(),c("dataSource",t.aclDeny),n(19),c("matHeaderRowDef",t.displayedColumns),n(),c("matRowDefColumns",t.displayedColumns),n(),c("ngIf",t.aclDeny.length==0)}}function fa(e,i){if(e&1){let t=R();o(0,"button",58),b("click",function(){D(t);let a=g();return A(a.save())}),s(1),p(2,"translate"),l()}if(e&2){let t=g();c("disabled",!t.checkFormValid()||t.loadingState),n(),h(d(2,2,"buttons.save"))}}var $t=class e extends X{constructor(t,r,a,m,u,y,I,P,U,M,ze,we){super(r,m,u,y);this.data=t;this.activeRoute=r;this.dialogRef=a;this.translateService=m;this.authenticationService=u;this.injector=y;this.userService=I;this.dialog=P;this.fb=U;this.permissionService=M;this.snackBar=ze;this.location=we;a.disableClose=!0,this.roles=t.roles,this.userInfo=JSON.parse(JSON.stringify(t.user)),this.statuses=t.statuses,this.dialogRef.keydownEvents().subscribe(St=>{St.key==="Escape"&&this.dialogRef.close()})}formUser;roles=[];statuses=[];packages=[];objectType="user";environment=k;title="User Permission";userInfo=new lt;acl=[];aclAll=[];aclAllow=[];aclDeny=[];domains=[];addOnBlur=!1;tabCurrent="permission-tab-user-info";displayedColumns=["sequence","allowed","name","groupName","package","uri"];separatorKeysCodes=[13,188];package="";keyword;ngOnInit(){this.initForm()}ngAfterViewInit(){setTimeout(()=>{this.getData()},0)}openSnackBar(t,r){this.snackBar.open(t,r,{horizontalPosition:"end",verticalPosition:"top",duration:10*1e3})}initForm(){this.formUser=this.fb.group({id:[this.userInfo?.id],email:[{value:this.userInfo?.email,disabled:!0}],roleId:[this.userInfo?.roleId],status:[this.userInfo?.status],fullName:[this.userInfo?.fullName??this.userInfo.email,[T.required,T.minLength(5),T.maxLength(255),$e,He(5)]]})}save(){if(this.checkFormValid()){let t=this.environment.rsa.isActive||!1;if(this.formUser.value.password&&this.formUser.invalid)return;let r=this.formUser.value.password,a=this.formUser.value.confirmPassword,m=this.formUser.value;this.loadingState=!0,this.userService.update(m,"",r,a,t).subscribe(u=>{if(this.loadingState=!1,u.status===1){this.getData(),this.dialogRef.close(!0),this.openSnackBar(this.translateService.instant("admin.system.user.notify.updateSuccess"),"");return}this.openSnackBar(this.translateService.instant("admin.system.user.notify.updateFailed"),"")})}}getData(){this.permissionService.details(this.objectType,this.userInfo.id).subscribe(t=>{this.acl=t.data.routes.all.length>0?t.data.routes.all:[],this.aclAll=this.acl,this.aclAllow=t.data.routes.allow.length>0?t.data.routes.allow:[],this.aclDeny=t.data.routes.deny.length>0?t.data.routes.deny:[],this.pageLength=t.count,this.domains=t.data.domains,this.packages=t.data.packages})}checkFormValid(){return this.formUser.valid}filterRoutes(t){this.aclAll=this.acl.filter(r=>{let a=this.keyword.nativeElement.value.trim(),m=a===""||a&&(r.name.toLowerCase().indexOf(a.toLowerCase())>=0||r.uri.toLowerCase().indexOf(a.toLowerCase())>=0)?!0:a==="",u=this.package===""?!0:!!(this.package&&this.package===r.vendor+" / "+r.package);return m&&u})}toggle(t,r){this.loadingState=!0,this.permissionService.set(this.objectType,this.userInfo.id,r,t.checked).subscribe(a=>{if(this.loadingState=!1,a.status===1){if(r.isAllow=a?.data?.allow,r.isAllow){this.aclAllow.push(r),this.aclAllow=[...this.aclAllow];let m=this.aclDeny.indexOf(r);this.aclDeny.splice(m,1),this.aclDeny=[...this.aclDeny]}else{this.aclDeny.push(r),this.aclDeny=[...this.aclDeny];let m=this.aclAllow.indexOf(r);this.aclAllow.splice(m,1),this.aclAllow=[...this.aclAllow]}this.openSnackBar(this.translateService.instant("admin.system.user.notify.updateSuccess"),"");return}this.openSnackBar(this.translateService.instant("admin.system.user.notify.updateFailed"),"")})}changeTab(t){switch(t.index){case 0:this.tabCurrent="permission-tab-user-info";break;case 1:this.tabCurrent="permission-tab-all-routes";break;case 2:this.tabCurrent="permission-tab-allowed-routes";break;case 3:this.tabCurrent="permission-tab-denied-routes";break;default:break}}static \u0275fac=function(r){return new(r||e)(v(Ne),v(q),v(Ue),v(J),v(Z),v(L),v(qe),v(Ce),v(Me),v(vt),v(xe),v(pe))};static \u0275cmp=F({type:e,selectors:[["app-admin-dialog-permission-user"]],viewQuery:function(r,a){if(r&1&&Ie(Zi,5),r&2){let m;De(m=Ae())&&(a.keyword=m.first)}},features:[O],decls:34,vars:26,consts:[["profileUser",""],["routeAll",""],["routeAllowed",""],["routeDeny",""],["keyword",""],["mat-dialog-title",""],["mat-stretch-tabs","false","mat-align-tabs","start","animationDuration","0ms",3,"selectedTabChange"],[3,"label"],[1,"f-s-14","p-16","rounded","m-t-12"],[4,"ngTemplateOutlet"],["align","end",1,"p-r-30","p-b-30"],["mat-stroked-button","","color","warn","mat-dialog-close",""],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"disabled","click",4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-sm-12","col-md-6"],[1,"f-w-600","d-block","m-b-10"],["appearance","outline",1,"w-100"],["type","text","formControlName","fullName","matInput","",3,"placeholder"],[4,"ngIf"],["type","text","formControlName","email","matInput","",3,"placeholder"],[1,"col-md-6","col-sm-12"],["appearance","outline",1,"input-height-46","w-100"],[3,"selectionChange","value"],[3,"value",4,"ngFor","ngForOf"],["class","m-b-0",4,"ngIf"],[1,"m-b-0"],[3,"value"],[1,"col-sm-12","p-l-0"],[1,"m-b-15","d-lg-flex","align-items-center"],["appearance","outline",1,"theme-select","m-r-10","d-flex","input-height-40"],["matInput","","type","text",3,"keydown.enter","placeholder"],["mat-flat-button","",1,"bg-primary","text-white","btn-height-40",3,"click"],["name","search",1,"icon-20","m-r-10"],[1,"row","table-responsive"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","sequence"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14 fixed-width-column",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",3,"width",4,"matCellDef"],["matColumnDef","allowed"],["matColumnDef","name"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","groupName"],["matColumnDef","package"],["matColumnDef","uri"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","text-center p-2",4,"ngIf"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14","fixed-width-column"],["mat-cell","",1,"mat-body-1"],[1,"f-s-15","f-w-700","m-t-4","m-b-0"],["color","primary",3,"change","checked"],[1,"f-w-600"],[1,"text-muted","font-size-base"],["mat-header-row",""],["mat-row",""],[1,"text-center","p-2"],[1,"text-muted"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click","disabled"]],template:function(r,a){if(r&1){let m=R();o(0,"h2",5),s(1),p(2,"translate"),l(),o(3,"mat-dialog-content")(4,"mat-tab-group",6),b("selectedTabChange",function(y){return D(m),A(a.changeTab(y))}),o(5,"mat-tab",7),p(6,"translate"),o(7,"div",8),_(8,tn,1,0,null,9),l()(),o(9,"mat-tab",7),p(10,"translate"),o(11,"div",8),_(12,an,1,0,null,9),l()(),o(13,"mat-tab",7),p(14,"translate"),o(15,"div",8),_(16,on,1,0,null,9),l()(),o(17,"mat-tab",7),p(18,"translate"),o(19,"div",8),_(20,mn,1,0,null,9),l()()(),_(21,Sn,33,25,"ng-template",null,0,ie)(23,Nn,35,14,"ng-template",null,1,ie)(25,Zn,23,4,"ng-template",null,2,ie)(27,_a,23,4,"ng-template",null,3,ie),l(),o(29,"mat-dialog-actions",10)(30,"button",11),s(31),p(32,"translate"),l(),_(33,fa,3,4,"button",12),l()}if(r&2){let m=V(22),u=V(24),y=V(26),I=V(28);n(),h(se(2,11,"admin.system.permission.titleForUser",me(24,Xi,a.user.fullName))),n(4),E("label",d(6,14,"admin.system.user.profile")),n(3),c("ngTemplateOutlet",m),n(),E("label",d(10,16,"admin.system.user.allRoute")),n(3),c("ngTemplateOutlet",u),n(),E("label",d(14,18,"admin.system.user.allowedRoute")),n(3),c("ngTemplateOutlet",y),n(),E("label",d(18,20,"admin.system.user.deniedRoute")),n(3),c("ngTemplateOutlet",I),n(11),h(d(32,22,"buttons.close")),n(2),c("ngIf",a.tabCurrent==="permission-tab-user-info")}},dependencies:[$,H,Dt,Te,z,G,Re,ke,Pe,ae,Q,K,W,Be,Rt,Tt,Ut,de,ue,he,_e,ce,ye,fe,ge,ve,Se,re,ne,Ve,je,Le,Fe,oe,Y],styles:[".admin-dialog-user-permission .mat-mdc-tab-body-content{overflow:hidden!important}  .admin-dialog-user-permission .mat-mdc-form-field-error-wrapper{padding:0}  .admin-dialog-user-permission .mdc-button__label{display:flex;align-items:center}"]})};var be=class{id=0;name="";status=0;permissionLocked=0;constructor(i){i&&(this.id=i.id||null,this.name=i.name||null,this.status=i.status||0,this.permissionLocked=i.permissionLocked||0)}};var le=class e{constructor(i,t){this.http=i;this.backendService=t}apiServerPaths=k.backendServer.paths;_getModel(i){let t=new be;return t.id=i.id,t.name=i.name,t.status=i.status,t.permissionLocked=i.permissionLocked,t}get(i){let t={params:{encryptParam:!0},headers:{Accept:"application/json"}};for(let r in i)t.params[r]=i[r];return this.backendService.get(this.apiServerPaths.administrator.role.list,t,B(r=>{let a=[],m=r.data.roles.data;for(let u in m)a.push(this._getModel(m[u]));return{data:a,count:r.data.roles.count}}))}checkNameExist(i){let t={params:{name:encodeURIComponent(i),encryptParam:!0,siteLoading:!1},headers:{Accept:"application/json"}};return this.backendService.get(this.apiServerPaths.administrator.role.checkNameExist,t,B(r=>({count:r.data.count})))}create(i){let t={name:i.name,status:i.status,permissionLocked:i.permissionLocked,encryptBody:!0};return this.backendService.post(this.apiServerPaths.administrator.role.create,t,B(r=>{let a=new be;return a.id=r.data.role.id,a.name=r.data.role.name,a.status=r.data.role.status,a.permissionLocked=parseInt(r.data.role.permissionLocked||0),a}))}update(i){let t={body:{id:i.id,name:i.name,status:i.status,encryptBody:!0,permissionLocked:i.permissionLocked}},r=this.apiServerPaths.administrator.role.update;return r=r.replace("{ROLE_ID}",i.id.toString()),this.backendService.put(r,t,B(a=>a))}delete(i){let t=this.apiServerPaths.administrator.role.delete;t=t.replace("{ROLE_ID}",i.id.toString());let r={encryptBody:!0};return this.backendService.delete(t,r,B(a=>a))}static \u0275fac=function(t){return new(t||e)(j(Ee),j(Oe))};static \u0275prov=te({token:e,factory:e.\u0275fac,providedIn:"root"})};var va=()=>["/"],Sa=e=>({count:e}),xa=e=>({"cursor-pointer":e}),Ca=(e,i,t)=>({"bg-success":e,"bg-warning":i,"bg-error":t});function ba(e,i){if(e&1&&(o(0,"mat-option",17),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.user.status."+t)," ")}}function wa(e,i){if(e&1&&(o(0,"mat-option",17),S(1),s(2),x(),l()),e&2){let t=i.$implicit;c("value",t.id),n(2),f(" ",t.name," ")}}function Ia(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function Da(e,i){if(e&1&&(o(0,"td",39)(1,"p",40),s(2),l()()),e&2){let t=i.index,r=g();w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function Aa(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.account")," "))}function Ea(e,i){if(e&1){let t=R();o(0,"td",39)(1,"div",41)(2,"div",42),C(3,"img",43),l(),o(4,"div",44)(5,"a",45),b("click",function(){let a=D(t).$implicit,m=g();return A(m.openDialogPermission(a))}),o(6,"span",46),s(7),l()(),o(8,"ul",47)(9,"li",48),C(10,"i-tabler",49),p(11,"translate"),o(12,"span",50),s(13),p(14,"date"),l()(),o(15,"li",51),C(16,"i-tabler",52),p(17,"translate"),o(18,"span",50),s(19),l()()()()()()}if(e&2){let t,r,a=i.$implicit,m=g();n(3),c("src",(t=a.avatar)!==null&&t!==void 0?t:m.avatarDefault,oi),n(3),c("ngClass",me(14,xa,a.roleId!==1)),n(),f(" ",(r=a.fullName)!==null&&r!==void 0?r:a.email," "),n(3),E("matTooltip",d(11,7,"admin.system.user.createdTime")),n(3),f(" ",se(14,9,a.createdAt,"HH:mm dd/MM/YYYY")," "),n(3),E("matTooltip",d(17,12,"admin.system.user.id")),n(3),f(" ",a.id," ")}}function Ra(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.email")," "))}function Ta(e,i){if(e&1&&(o(0,"td",39)(1,"h5",53),s(2),l()()),e&2){let t=i.$implicit;w("width",500,"px"),n(2),h(t.email)}}function ka(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.status")," "))}function Pa(e,i){if(e&1&&(o(0,"td",39)(1,"div")(2,"span",54),s(3),p(4,"translate"),l()()()),e&2){let t=i.$implicit;w("width",150,"px"),n(2),c("ngClass",mi(6,Ca,t.status===1,t.status===0,t.status===-1)),n(),f(" ",d(4,4,"admin.system.user.status."+t.status)," ")}}function Ma(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.user.role")," "))}function Ba(e,i){if(e&1&&(o(0,"mat-option",17),S(1),s(2),x(),l()),e&2){let t=i.$implicit;c("value",t.id),n(2),f(" ",t.name," ")}}function Ua(e,i){if(e&1){let t=R();o(0,"td",39)(1,"mat-form-field",55)(2,"mat-select",56),b("selectionChange",function(a){let m=D(t).$implicit,u=g();return A(u.setRole(a,m))}),_(3,Ba,3,2,"mat-option",18),l()()()}if(e&2){let t=i.$implicit,r=g();w("width",250,"px"),n(),w("width",250,"px"),n(),c("value",t.roleId)("disabled",t.roleId===1),n(),c("ngForOf",r.roles)}}function Na(e,i){e&1&&C(0,"th",38)}function Va(e,i){if(e&1&&(o(0,"button",62),C(1,"i-tabler",63),l()),e&2){g();let t=V(3);c("matMenuTriggerFor",t)}}function ja(e,i){if(e&1){let t=R();o(0,"td",57),_(1,Va,2,1,"button",58),o(2,"mat-menu",59,0)(4,"button",60),b("click",function(){let a=D(t).$implicit,m=g();return A(m.openDialogPermission(a))}),o(5,"mat-icon"),C(6,"i-tabler",61),l(),o(7,"span"),s(8),p(9,"translate"),l()(),C(10,"mat-divider"),l()()}if(e&2){let t=i.$implicit;w("width",50,"px"),n(),c("ngIf",t.roleId!==1),n(7),h(d(9,4,"admin.system.user.permission"))}}function Fa(e,i){e&1&&C(0,"tr",64)}function La(e,i){e&1&&C(0,"tr",65)}function Oa(e,i){e&1&&C(0,"mat-divider",66)}var qt=class e extends X{constructor(t,r,a,m,u,y,I,P,U){super(t,r,a,m);this.activeRoute=t;this.translateService=r;this.authenticationService=a;this.injector=m;this.userService=u;this.roleService=y;this.dialog=I;this.snackBar=P;this.location=U;this.activeRoute.queryParams.subscribe(M=>{this.currentPage=M.page??1,this.currentPage=parseInt(this.currentPage.toString()),this.pageIndex=this.currentPage-1,this.filter.role=M.role?parseInt(M.role):-1,this.filter.status=M.hasOwnProperty("status")?parseInt(M.status):-2,this.filter.keyword=M.keyword??""})}filterCount=0;filter={status:-2,role:-1,keyword:""};statuses=[-1,0,1];roles=[];users=[];sidenavSubscription=null;displayedColumns=["sequence","name","email","status","role","action"];subscribeUser;avatarDefault="./assets/images/profiles/user-1.jpg";environment=k;ngOnInit(){super.ngOnInit(),this.search(),this._getRoles({})}ngOnDestroy(){super.ngOnDestroy()}search(t=!0){let r={limit:this.pageSize,loadingState:t,page:this.currentPage};this.filter.status!==-2&&(r.status=this.filter.status),this.filter.role&&this.filter.role!==-1&&(r.role=this.filter.role),this.filter.keyword!==""&&(r.keyword=encodeURIComponent(this.filter.keyword)),this.subscribeUser=this.userService.get(r).subscribe(m=>{this.loadingState=!1,this.users=m.data.length>0?m.data:[],this.filterCount=m.count,this.pageLength=m.count});let a=[];for(let m in r)a.push(m+"="+r[m]);this.location.replaceState(`/${k.administratorPrefix}/system/manage-user`,a.join("&"))}_getRoles(t){this.roleService.get(t).subscribe(r=>{this.roles=r.data.length>0?r.data:[]})}onInputKeyword(t){let r=t.target.value;this.filter.keyword=r,this.pageIndex=0,this.currentPage=1,this.search()}onSelectStatusChange(t){this.filter.status=t.value,this.search()}onSelectRoleChange(t){this.filter.role=t.value,this.search()}onPageChange(t){this.loadingState||this.pageSize===t.pageSize&&this.pageIndex===t.pageIndex||(this.pageIndex=t.pageIndex,this.currentPage=t.pageIndex+1,this.pageSize=t.pageSize,this.search())}openDialogCreateUser(){this.dialog.open(Ft,{width:"800px",panelClass:"admin-dialog-system-create-user",data:{roles:this.roles,statuses:this.statuses}}).afterClosed().subscribe(r=>{r&&this.search()})}openDialogPermission(t){if(t.roleId==1)return;this.dialog.open($t,{autoFocus:!1,panelClass:"admin-dialog-user-permission",width:"1200px",height:"auto",maxHeight:"80vh",data:{user:t,roles:this.roles,statuses:this.statuses}}).afterClosed().subscribe(a=>{a&&this.search()})}setRole(t,r){let a=t.value;this.loadingState=!0;let m=this.environment.rsa.isActive||!1;this.userService.setRole(r.id,a,m).subscribe(u=>{if(this.loadingState=!1,u.status===1){this.users.filter(y=>y.id===r.id).forEach(y=>{y.roleId=Number(a)}),this.openSnackBar(this.translateService.instant("admin.system.user.notify.updateSuccess"),"");return}this.openSnackBar(this.translateService.instant("admin.system.user.notify.updateFailed"),"")})}openSnackBar(t,r){this.snackBar.open(t,r,{horizontalPosition:"end",verticalPosition:"top",duration:10*1e3})}static \u0275fac=function(r){return new(r||e)(v(q),v(J),v(Z),v(L),v(qe),v(le),v(Ce),v(xe),v(pe))};static \u0275cmp=F({type:e,selectors:[["app-admin-system-user"]],features:[O],decls:72,vars:55,consts:[["menu","matMenu"],[1,"bg-white","rounded","p-20","m-b-30"],[1,"row"],[1,"col-sm-8"],[1,"page-title","m-0","f-s-18","f-w-600"],[1,"col-sm-4","text-right"],[1,"d-flex","align-items-center","justify-content-start","justify-content-lg-end"],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"text-body-color",3,"routerLink"],["name","circle-filled",1,"icon-8"],[1,"cardWithShadow","widget-container"],[1,"p-t-0"],[1,"p-t-0","p-b-20","d-lg-flex"],["appearance","outline",1,"theme-select","m-r-10","d-flex","m-t-20","input-height-46"],["type","text","matInput","",3,"keyup.enter","ngModelChange","placeholder","ngModel"],[3,"selectionChange","value"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"m-r-10","p-t-12","m-t-24",3,"innerHTML"],["mat-mini-fab","","color","primary m-t-24",1,"d-flex",3,"click"],["data-icon","solar:refresh-bold",1,"iconify","icon-20","d-flex"],[1,"table-responsive"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","sequence"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14 fixed-width-column",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",3,"width",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","status"],["matColumnDef","role"],["matColumnDef","action"],["mat-cell","","class","text-center mat-body-1",3,"width",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","m-b-10",4,"ngIf"],["aria-label","Select page",3,"page","length","pageIndex","pageSize","pageSizeOptions"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14","fixed-width-column"],["mat-cell","",1,"mat-body-1"],[1,"f-s-15","f-w-700","m-t-4","m-b-0"],[1,"d-flex"],[1,"cover","p-r-10","d-flex","align-items-center"],["width","55px",1,"rounded-circle",3,"src"],[1,""],[3,"click"],[1,"text-primary",3,"ngClass"],[1,"d-flex","p-l-0","m-b-0"],[1,"text-muted","d-flex","align-items-center","p-r-15"],["name","calendar-clock",1,"icon-18",3,"matTooltip"],[1,"p-l-6"],[1,"text-muted","d-flex","align-items-center"],["name","user-circle",1,"icon-18",3,"matTooltip"],[1,"f-s-14","fw-normal","m-b-0","m-t-0"],[1,"rounded","f-w-600","p-6","p-y-4","f-s-12","m-t-8","text-white",3,"ngClass"],["appearance","outline",1,"theme-select","d-flex","input-height-46"],[3,"selectionChange","value","disabled"],["mat-cell","",1,"text-center","mat-body-1"],["mat-icon-button","","aria-label","action",3,"matMenuTriggerFor",4,"ngIf"],[1,"cardWithShadow"],["mat-menu-item","",3,"click"],["name","shield-cog"],["mat-icon-button","","aria-label","action",3,"matMenuTriggerFor"],["name","dots-vertical"],["mat-header-row",""],["mat-row",""],[1,"m-b-10"]],template:function(r,a){r&1&&(o(0,"div",1)(1,"div",2)(2,"div",3)(3,"h4",4),s(4),p(5,"translate"),l()(),o(6,"div",5)(7,"div",6)(8,"ul",7)(9,"li",8)(10,"a",9),s(11),p(12,"translate"),l()(),o(13,"li",8),C(14,"i-tabler",10),l()()()()()(),o(15,"mat-card",11)(16,"mat-card-content",12)(17,"div",13)(18,"mat-form-field",14)(19,"mat-label"),s(20),p(21,"translate"),l(),o(22,"input",15),p(23,"translate"),b("keyup.enter",function(u){return a.onInputKeyword(u)}),Qe("ngModelChange",function(u){return Ke(a.filter.keyword,u)||(a.filter.keyword=u),u}),l()(),o(24,"mat-form-field",14)(25,"mat-label"),s(26),p(27,"translate"),l(),o(28,"mat-select",16),b("selectionChange",function(u){return a.onSelectStatusChange(u)}),o(29,"mat-option",17),s(30),p(31,"translate"),l(),_(32,ba,4,4,"mat-option",18),l()(),o(33,"mat-form-field",14)(34,"mat-label"),s(35),p(36,"translate"),l(),o(37,"mat-select",16),b("selectionChange",function(u){return a.onSelectRoleChange(u)}),o(38,"mat-option",17),s(39),p(40,"translate"),l(),_(41,wa,3,2,"mat-option",18),l()(),C(42,"div",19),p(43,"number"),p(44,"translate"),o(45,"button",20),b("click",function(){return a.search()}),C(46,"i",21),l()(),C(47,"mat-divider"),o(48,"div",22)(49,"table",23),S(50,24),_(51,Ia,3,3,"th",25)(52,Da,3,3,"td",26),x(),S(53,27),_(54,Aa,3,3,"th",25)(55,Ea,20,16,"td",28),x(),S(56,29),_(57,Ra,3,3,"th",25)(58,Ta,3,3,"td",26),x(),S(59,30),_(60,ka,3,3,"th",25)(61,Pa,5,10,"td",26),x(),S(62,31),_(63,Ma,3,3,"th",25)(64,Ua,4,7,"td",26),x(),S(65,32),_(66,Na,1,0,"th",25)(67,ja,11,6,"td",33),x(),_(68,Fa,1,0,"tr",34)(69,La,1,0,"tr",35),l()(),_(70,Oa,1,0,"mat-divider",36),o(71,"mat-paginator",37),b("page",function(u){return a.onPageChange(u)}),l()()()),r&2&&(n(4),f(" ",d(5,31,"admin.system.user.title")," "),n(6),c("routerLink",Je(52,va)),n(),h(d(12,33,"labels.dashboard")),n(7),w("width",300,"px"),n(2),h(d(21,35,"admin.system.user.keywordLabel")),n(2),E("placeholder",d(23,37,"admin.system.user.placeholder.enterKeyword")),We("ngModel",a.filter.keyword),n(2),w("width",200,"px"),n(2),h(d(27,39,"admin.system.user.status")),n(2),c("value",a.filter.status),n(),c("value",-2),n(),h(d(31,41,"labels.all")),n(2),c("ngForOf",a.statuses),n(),w("width",200,"px"),n(2),h(d(36,43,"admin.system.user.role")),n(2),c("value",a.filter.role),n(),c("value",-1),n(),h(d(40,45,"labels.all")),n(2),c("ngForOf",a.roles),n(),c("innerHTML",se(44,49,"admin.system.user.findCountUser",me(53,Sa,d(43,47,a.filterCount))),Ge),n(7),c("dataSource",a.users),n(19),c("matHeaderRowDef",a.displayedColumns),n(),c("matRowDefColumns",a.displayedColumns),n(),c("ngIf",a.pageLength),n(),c("length",a.pageLength)("pageIndex",a.pageIndex)("pageSize",a.pageSize)("pageSizeOptions",a.pageSizeOptions))},dependencies:[Ye,$,H,z,G,it,Xe,tt,et,Q,K,W,Et,nt,at,Pt,kt,Mt,de,ue,he,_e,ce,ye,fe,ge,ve,Se,re,ne,rt,Bt,ot,oe,Ze,pi,Y],styles:["ul li{list-style:none}"]})};function $a(e,i){e&1&&(o(0,"span",16),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.required")," "))}function Ha(e,i){e&1&&(o(0,"span",16),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.minLength")," "))}function qa(e,i){e&1&&(o(0,"span",16),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.maxLength")," "))}function za(e,i){e&1&&(o(0,"span",16),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.existed")," "))}function Ga(e,i){e&1&&(o(0,"span",16),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.excessWhiteSpace")," "))}function Wa(e,i){e&1&&(o(0,"span",16),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.htmlTag")," "))}function Ka(e,i){if(e&1&&(o(0,"mat-error"),_(1,$a,3,3,"span",15)(2,Ha,3,3,"span",15)(3,qa,3,3,"span",15)(4,za,3,3,"span",15)(5,Ga,3,3,"span",15)(6,Wa,3,3,"span",15),l()),e&2){let t,r,a,m,u,y,I=g();n(),c("ngIf",(t=I.formRole.get("name"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=I.formRole.get("name"))==null||r.errors==null?null:r.errors.minlength),n(),c("ngIf",(a=I.formRole.get("name"))==null||a.errors==null?null:a.errors.maxlength),n(),c("ngIf",(m=I.formRole.get("name"))==null||m.errors==null?null:m.errors.existed),n(),c("ngIf",(u=I.formRole.get("name"))==null||u.errors==null?null:u.errors.excessWhiteSpace),n(),c("ngIf",(y=I.formRole.get("name"))==null||y.errors==null?null:y.errors.htmlTag)}}function Qa(e,i){if(e&1&&(o(0,"mat-option",17),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.role.status."+t)," ")}}function Ja(e,i){if(e&1&&(o(0,"mat-option",17),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.role.permissionLocked."+t)," ")}}var zt=class e extends X{constructor(t,r,a,m,u,y,I,P,U){super(t,r,a,m);this.activeRoute=t;this.translateService=r;this.authenticationService=a;this.injector=m;this.dialogRef=u;this.data=y;this.roleService=I;this.fb=P;this.snackBar=U;this.statuses=this.data.statuses??[],this.dialogRef.keydownEvents().subscribe(M=>{M.key==="Escape"&&this.dialogRef.close()}),this.statuses=y.statuses,this.listPermissionLocked=y.listPermissionLocked,this.formRole=this.fb.group({name:["",[T.required,T.minLength(3),T.maxLength(255),$e,He(3)]],status:[1,[T.required]],permissionLocked:[0,[T.required]]}),this.formRole.controls.name.valueChanges.pipe(ri(300)).subscribe(M=>{this.checkNameExist(M)}),this.formRole.get("name")?.setErrors({existed:!1})}statuses=[];listPermissionLocked=[1,0];formRole;openSnackBar(t,r){this.snackBar.open(t,r,{horizontalPosition:"end",verticalPosition:"top",duration:10*1e3})}checkNameExist(t){this.formRole.invalid||(this.loadingState=!1,this.roleService.checkNameExist(t).subscribe(r=>{r.count>0?this.formRole.get("name")?.setErrors({existed:!0}):this.formRole.get("name")?.setErrors(null)}))}isValid(){return this.formRole.valid}save(){if(this.formRole.valid){this.loadingState=!0;let t={name:this.formRole.controls.name.value.trim(),status:this.formRole.controls.status.value,permissionLocked:this.formRole.controls.permissionLocked.value};this.roleService.create(new be(t)).subscribe(r=>{if(this.loadingState=!1,r){this.openSnackBar(this.translateService.instant("admin.system.role.notify.createSuccess"),""),this.dialogRef.close(!0);return}this.openSnackBar(this.translateService.instant("admin.system.role.notify.createFailed"),"")})}}static \u0275fac=function(r){return new(r||e)(v(q),v(J),v(Z),v(L),v(Ue),v(Ne),v(le),v(Me),v(xe))};static \u0275cmp=F({type:e,selectors:[["app-admin-dialog-system-create-role"]],features:[O],decls:37,vars:28,consts:[["mat-dialog-title",""],[3,"formGroup"],[1,"row"],[1,"col-sm-12"],[1,"f-w-600","d-block","m-b-10"],["appearance","outline",1,"w-100"],["type","text","formControlName","name","matInput","",3,"placeholder"],[4,"ngIf"],[1,"row","m-b-20"],["appearance","outline",1,"d-flex","input-height-46","w-100"],[3,"selectionChange","value"],[3,"value",4,"ngFor","ngForOf"],["align","end",1,"p-r-30","p-b-30"],["mat-stroked-button","","color","warn","mat-dialog-close",""],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click","disabled"],["class","m-b-0",4,"ngIf"],[1,"m-b-0"],[3,"value"]],template:function(r,a){if(r&1&&(o(0,"h2",0),s(1),p(2,"translate"),l(),o(3,"mat-dialog-content")(4,"form",1)(5,"div",2)(6,"div",3)(7,"mat-label",4),s(8),p(9,"translate"),l(),o(10,"mat-form-field",5),C(11,"input",6),p(12,"translate"),_(13,Ka,7,6,"mat-error",7),l()()(),o(14,"div",8)(15,"div",3)(16,"mat-label",4),s(17),p(18,"translate"),l(),o(19,"mat-form-field",9)(20,"mat-select",10),b("selectionChange",function(u){let y;return(y=a.formRole.get("status"))==null?null:y.setValue(u.value)}),_(21,Qa,4,4,"mat-option",11),l()()()(),o(22,"div",2)(23,"div",3)(24,"mat-label",4),s(25),p(26,"translate"),l(),o(27,"mat-form-field",9)(28,"mat-select",10),b("selectionChange",function(u){let y;return(y=a.formRole.get("permissionLocked"))==null?null:y.setValue(u.value)}),_(29,Ja,4,4,"mat-option",11),l()()()()()(),o(30,"mat-dialog-actions",12)(31,"button",13),s(32),p(33,"translate"),l(),o(34,"button",14),b("click",function(){return a.save()}),s(35),p(36,"translate"),l()()),r&2){let m,u,y;n(),h(d(2,14,"admin.system.role.createRole")),n(3),c("formGroup",a.formRole),n(4),h(d(9,16,"admin.system.role.name")),n(3),E("placeholder",d(12,18,"admin.system.role.placeholder.enterName")),n(2),c("ngIf",((m=a.formRole.get("name"))==null?null:m.invalid)&&((m=a.formRole.get("name"))==null?null:m.touched)),n(4),h(d(18,20,"admin.system.role.status")),n(3),c("value",(u=a.formRole.get("status"))==null?null:u.value),n(),c("ngForOf",a.statuses),n(4),h(d(26,22,"admin.system.role.permissionLocked")),n(3),c("value",(y=a.formRole.get("permissionLocked"))==null?null:y.value),n(),c("ngForOf",a.listPermissionLocked),n(3),h(d(33,24,"buttons.close")),n(2),c("disabled",!a.isValid()||a.loadingState),n(),h(d(36,26,"buttons.save"))}},dependencies:[$,H,Te,z,G,Re,ke,Pe,ae,Q,K,W,Be,re,ne,Ve,je,Le,Fe,Y],styles:[".mat-mdc-form-field-error-wrapper{padding:0}"]})};var Ya=["keyword"],Za=e=>({name:e});function Xa(e,i){}function er(e,i){e&1&&_(0,Xa,0,0,"ng-template")}function tr(e,i){}function ir(e,i){e&1&&_(0,tr,0,0,"ng-template")}function nr(e,i){}function ar(e,i){e&1&&_(0,nr,0,0,"ng-template")}function rr(e,i){}function or(e,i){e&1&&_(0,rr,0,0,"ng-template")}function lr(e,i){e&1&&(o(0,"span",25),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.required")," "))}function mr(e,i){e&1&&(o(0,"span",25),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.minLength")," "))}function sr(e,i){e&1&&(o(0,"span",25),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.maxLength")," "))}function pr(e,i){e&1&&(o(0,"span",25),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.validatedErrors.name.existed")," "))}function dr(e,i){e&1&&(o(0,"span",25),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.excessWhiteSpace")," "))}function cr(e,i){e&1&&(o(0,"span",25),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"validatedErrors.htmlTag")," "))}function ur(e,i){if(e&1&&(o(0,"mat-error"),_(1,lr,3,3,"span",24)(2,mr,3,3,"span",24)(3,sr,3,3,"span",24)(4,pr,3,3,"span",24)(5,dr,3,3,"span",24)(6,cr,3,3,"span",24),l()),e&2){let t,r,a,m,u,y,I=g(2);n(),c("ngIf",(t=I.formRole.get("name"))==null||t.errors==null?null:t.errors.required),n(),c("ngIf",(r=I.formRole.get("name"))==null||r.errors==null?null:r.errors.minlength),n(),c("ngIf",(a=I.formRole.get("name"))==null||a.errors==null?null:a.errors.maxlength),n(),c("ngIf",(m=I.formRole.get("name"))==null||m.errors==null?null:m.errors.existed),n(),c("ngIf",(u=I.formRole.get("name"))==null||u.errors==null?null:u.errors.excessWhiteSpace),n(),c("ngIf",(y=I.formRole.get("name"))==null||y.errors==null?null:y.errors.htmlTag)}}function _r(e,i){if(e&1&&(o(0,"mat-option",26),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.role.status."+t)," ")}}function fr(e,i){if(e&1&&(o(0,"mat-option",26),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.role.permissionLocked."+t)," ")}}function gr(e,i){if(e&1){let t=R();o(0,"form",13)(1,"div",14)(2,"div",15)(3,"mat-label",16),s(4),p(5,"translate"),l(),o(6,"mat-form-field",17),C(7,"input",18),p(8,"translate"),_(9,ur,7,6,"mat-error",19),l()()(),o(10,"div",20)(11,"div",15)(12,"mat-label",16),s(13),p(14,"translate"),l(),o(15,"mat-form-field",21)(16,"mat-select",22),b("selectionChange",function(a){let m;D(t);let u=g();return A((m=u.formRole.get("status"))==null?null:m.setValue(a.value))}),_(17,_r,4,4,"mat-option",23),l()()()(),o(18,"div",14)(19,"div",15)(20,"mat-label",16),s(21),p(22,"translate"),l(),o(23,"mat-form-field",21)(24,"mat-select",22),b("selectionChange",function(a){let m;D(t);let u=g();return A((m=u.formRole.get("permissionLocked"))==null?null:m.setValue(a.value))}),_(25,fr,4,4,"mat-option",23),l()()()()()}if(e&2){let t,r,a,m=g();c("formGroup",m.formRole),n(4),h(d(5,10,"admin.system.role.name")),n(3),E("placeholder",d(8,12,"admin.system.role.placeholder.enterName")),n(2),c("ngIf",((t=m.formRole.get("name"))==null?null:t.invalid)&&((t=m.formRole.get("name"))==null?null:t.touched)),n(4),h(d(14,14,"admin.system.role.status")),n(3),c("value",(r=m.formRole.get("status"))==null?null:r.value),n(),c("ngForOf",m.statuses),n(4),h(d(22,16,"admin.system.role.permissionLocked")),n(3),c("value",(a=m.formRole.get("permissionLocked"))==null?null:a.value),n(),c("ngForOf",m.listPermissionLocked)}}function hr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function yr(e,i){if(e&1&&(o(0,"td",48)(1,"p",49),s(2),l()()),e&2){let t=i.index,r=g(2);w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function vr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.allowed")," "))}function Sr(e,i){if(e&1){let t=R();o(0,"td",48)(1,"mat-slide-toggle",50),b("change",function(a){let m=D(t).$implicit,u=g(2);return A(u.toggle(a,m))}),l()()}if(e&2){let t=i.$implicit;w("width",120,"px"),n(),c("checked",!!t.isAllow)}}function xr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.name")," "))}function Cr(e,i){if(e&1&&(o(0,"td",48)(1,"span",51),s(2),l(),o(3,"ul",25)(4,"li",52),s(5),p(6,"translate"),l(),o(7,"li",52),s(8),p(9,"translate"),l()()()),e&2){let t=i.$implicit;n(2),h(t.name),n(3),N("",d(6,5,"admin.system.permission.controller"),": ",t.controller,""),n(3),N("",d(9,7,"admin.system.permission.middleware"),": ",t.middleware.join(", "),"")}}function br(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.groupName")," "))}function wr(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",200,"px"),n(2),h(t.groupName)}}function Ir(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.package")," "))}function Dr(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",100,"px"),n(2),N("",t.vendor," / ",t.package,"")}}function Ar(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.uri")," "))}function Er(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",250,"px"),n(2),h(t.uri)}}function Rr(e,i){e&1&&C(0,"tr",53)}function Tr(e,i){e&1&&C(0,"tr",54)}function kr(e,i){e&1&&(o(0,"div",55)(1,"div",56),s(2),p(3,"translate"),l()()),e&2&&(n(2),h(d(3,1,"dataNotFound")))}function Pr(e,i){if(e&1){let t=R();o(0,"div",14)(1,"div",27)(2,"div",28)(3,"mat-form-field",29)(4,"input",30,4),p(6,"translate"),b("keydown.enter",function(a){D(t);let m=g();return A(m.filterRoutes(a))}),l()(),o(7,"button",31),b("click",function(a){D(t);let m=g();return A(m.filterRoutes(a))}),C(8,"i-tabler",32),o(9,"span"),s(10),p(11,"translate"),l()()()()(),o(12,"div",33)(13,"table",34),S(14,35),_(15,hr,3,3,"th",36)(16,yr,3,3,"td",37),x(),S(17,38),_(18,vr,3,3,"th",36)(19,Sr,2,3,"td",37),x(),S(20,39),_(21,xr,3,3,"th",36)(22,Cr,10,9,"td",40),x(),S(23,41),_(24,br,3,3,"th",36)(25,wr,3,3,"td",37),x(),S(26,42),_(27,Ir,3,3,"th",36)(28,Dr,3,4,"td",37),x(),S(29,43),_(30,Ar,3,3,"th",36)(31,Er,3,3,"td",37),x(),_(32,Rr,1,0,"tr",44)(33,Tr,1,0,"tr",45),l()(),_(34,kr,4,3,"div",46)}if(e&2){let t=g();n(3),w("width",400,"px"),n(),E("placeholder",d(6,10,"admin.system.permission.placeholder.enterKeyword")),n(3),w("width",120,"px"),n(3),h(d(11,12,"buttons.search")),n(3),c("dataSource",t.aclAll),n(19),c("matHeaderRowDef",t.displayedColumns),n(),c("matRowDefColumns",t.displayedColumns),n(),c("ngIf",t.aclAll.length==0)}}function Mr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function Br(e,i){if(e&1&&(o(0,"td",48)(1,"p",49),s(2),l()()),e&2){let t=i.index,r=g(2);w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function Ur(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.allowed")," "))}function Nr(e,i){if(e&1){let t=R();o(0,"td",48)(1,"mat-slide-toggle",50),b("change",function(a){let m=D(t).$implicit,u=g(2);return A(u.toggle(a,m))}),l()()}if(e&2){let t=i.$implicit;w("width",120,"px"),n(),c("checked",!!t.isAllow)}}function Vr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.name")," "))}function jr(e,i){if(e&1&&(o(0,"td",48)(1,"span",51),s(2),l(),o(3,"ul",25)(4,"li",52),s(5),p(6,"translate"),l(),o(7,"li",52),s(8),p(9,"translate"),l()()()),e&2){let t=i.$implicit;n(2),h(t.name),n(3),N("",d(6,5,"admin.system.permission.controller"),": ",t.controller,""),n(3),N("",d(9,7,"admin.system.permission.middleware"),": ",t.middleware.join(", "),"")}}function Fr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.groupName")," "))}function Lr(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",200,"px"),n(2),h(t.groupName)}}function Or(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.package")," "))}function $r(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",100,"px"),n(2),N("",t.vendor," / ",t.package,"")}}function Hr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.uri")," "))}function qr(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",250,"px"),n(2),h(t.uri)}}function zr(e,i){e&1&&C(0,"tr",53)}function Gr(e,i){e&1&&C(0,"tr",54)}function Wr(e,i){e&1&&(o(0,"div",55)(1,"div",56),s(2),p(3,"translate"),l()()),e&2&&(n(2),h(d(3,1,"dataNotFound")))}function Kr(e,i){if(e&1&&(o(0,"div",33)(1,"table",34),S(2,35),_(3,Mr,3,3,"th",36)(4,Br,3,3,"td",37),x(),S(5,38),_(6,Ur,3,3,"th",36)(7,Nr,2,3,"td",37),x(),S(8,39),_(9,Vr,3,3,"th",36)(10,jr,10,9,"td",40),x(),S(11,41),_(12,Fr,3,3,"th",36)(13,Lr,3,3,"td",37),x(),S(14,42),_(15,Or,3,3,"th",36)(16,$r,3,4,"td",37),x(),S(17,43),_(18,Hr,3,3,"th",36)(19,qr,3,3,"td",37),x(),_(20,zr,1,0,"tr",44)(21,Gr,1,0,"tr",45),l()(),_(22,Wr,4,3,"div",46)),e&2){let t=g();n(),c("dataSource",t.aclAllow),n(19),c("matHeaderRowDef",t.displayedColumns),n(),c("matRowDefColumns",t.displayedColumns),n(),c("ngIf",t.aclAllow.length==0)}}function Qr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function Jr(e,i){if(e&1&&(o(0,"td",48)(1,"p",49),s(2),l()()),e&2){let t=i.index,r=g(2);w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function Yr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.allowed")," "))}function Zr(e,i){if(e&1){let t=R();o(0,"td",48)(1,"mat-slide-toggle",50),b("change",function(a){let m=D(t).$implicit,u=g(2);return A(u.toggle(a,m))}),l()()}if(e&2){let t=i.$implicit;w("width",120,"px"),n(),c("checked",!!t.isAllow)}}function Xr(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.name")," "))}function eo(e,i){if(e&1&&(o(0,"td",48)(1,"span",51),s(2),l(),o(3,"ul",25)(4,"li",52),s(5),p(6,"translate"),l(),o(7,"li",52),s(8),p(9,"translate"),l()()()),e&2){let t=i.$implicit;n(2),h(t.name),n(3),N("",d(6,5,"admin.system.permission.controller"),": ",t.controller,""),n(3),N("",d(9,7,"admin.system.permission.middleware"),": ",t.middleware.join(", "),"")}}function to(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.groupName")," "))}function io(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",200,"px"),n(2),h(t.groupName)}}function no(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.package")," "))}function ao(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",100,"px"),n(2),N("",t.vendor," / ",t.package,"")}}function ro(e,i){e&1&&(o(0,"th",47),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.permission.uri")," "))}function oo(e,i){if(e&1&&(o(0,"td",48)(1,"span"),s(2),l()()),e&2){let t=i.$implicit;w("width",250,"px"),n(2),h(t.uri)}}function lo(e,i){e&1&&C(0,"tr",53)}function mo(e,i){e&1&&C(0,"tr",54)}function so(e,i){e&1&&(o(0,"div",55)(1,"div",56),s(2),p(3,"translate"),l()()),e&2&&(n(2),h(d(3,1,"dataNotFound")))}function po(e,i){if(e&1&&(o(0,"div",33)(1,"table",34),S(2,35),_(3,Qr,3,3,"th",36)(4,Jr,3,3,"td",37),x(),S(5,38),_(6,Yr,3,3,"th",36)(7,Zr,2,3,"td",37),x(),S(8,39),_(9,Xr,3,3,"th",36)(10,eo,10,9,"td",40),x(),S(11,41),_(12,to,3,3,"th",36)(13,io,3,3,"td",37),x(),S(14,42),_(15,no,3,3,"th",36)(16,ao,3,4,"td",37),x(),S(17,43),_(18,ro,3,3,"th",36)(19,oo,3,3,"td",37),x(),_(20,lo,1,0,"tr",44)(21,mo,1,0,"tr",45),l()(),_(22,so,4,3,"div",46)),e&2){let t=g();n(),c("dataSource",t.aclDeny),n(19),c("matHeaderRowDef",t.displayedColumns),n(),c("matRowDefColumns",t.displayedColumns),n(),c("ngIf",t.aclDeny.length==0)}}function co(e,i){if(e&1){let t=R();o(0,"button",57),b("click",function(){D(t);let a=g();return A(a.save())}),s(1),p(2,"translate"),l()}if(e&2){let t=g();c("disabled",!t.checkFormValid()||t.loadingState),n(),h(d(2,2,"buttons.save"))}}var Gt=class e extends X{constructor(t,r,a,m,u,y,I,P,U,M,ze,we){super(r,m,u,y);this.data=t;this.activeRoute=r;this.dialogRef=a;this.translateService=m;this.authenticationService=u;this.injector=y;this.roleService=I;this.dialog=P;this.fb=U;this.permissionService=M;this.snackBar=ze;this.location=we;a.disableClose=!0,this.roleInfo=JSON.parse(JSON.stringify(t.role)),this.statuses=t.statuses,this.dialogRef.keydownEvents().subscribe(St=>{St.key==="Escape"&&this.dialogRef.close()})}formRole;statuses=[];packages=[];objectType="role";environment=k;title="Role Permission";roleInfo=new be;acl=[];aclAll=[];aclAllow=[];aclDeny=[];domains=[];addOnBlur=!1;tabCurrent="permission-tab-role-info";displayedColumns=["sequence","allowed","name","groupName","package","uri"];separatorKeysCodes=[13,188];package="";listPermissionLocked=[1,0];keyword;ngOnInit(){this.initForm()}ngAfterViewInit(){setTimeout(()=>{this.getData()},0)}openSnackBar(t,r){this.snackBar.open(t,r,{horizontalPosition:"end",verticalPosition:"top",duration:10*1e3})}initForm(){this.formRole=this.fb.group({id:[this.roleInfo.id],name:[this.roleInfo.name,[T.required,T.minLength(3),T.maxLength(255),$e,He(3)]],status:[this.roleInfo.status,[T.required]],permissionLocked:[this.roleInfo.permissionLocked,[T.required]]})}save(){if(this.checkFormValid()){let t=this.formRole.value;this.loadingState=!0,this.roleService.update(new be(t)).subscribe(r=>{if(this.loadingState=!1,r.status===1){this.getData(),this.dialogRef.close(!0),this.openSnackBar(this.translateService.instant("admin.system.role.notify.updateSuccess"),"");return}this.openSnackBar(this.translateService.instant("admin.system.role.notify.updateFailed"),"")})}}getData(){this.permissionService.details(this.objectType,this.roleInfo.id).subscribe(t=>{this.acl=t.data.routes.all.length>0?t.data.routes.all:[],this.aclAll=this.acl,this.aclAllow=t.data.routes.allow.length>0?t.data.routes.allow:[],this.aclDeny=t.data.routes.deny.length>0?t.data.routes.deny:[],this.pageLength=t.count,this.domains=t.data.domains,this.packages=t.data.packages})}checkFormValid(){return this.formRole.valid}filterRoutes(t){this.aclAll=this.acl.filter(r=>{let a=this.keyword.nativeElement.value.trim(),m=a===""||a&&(r.name.toLowerCase().indexOf(a.toLowerCase())>=0||r.uri.toLowerCase().indexOf(a.toLowerCase())>=0)?!0:a==="",u=this.package===""?!0:!!(this.package&&this.package===r.vendor+" / "+r.package);return m&&u})}toggle(t,r){this.loadingState=!0,this.permissionService.set(this.objectType,this.roleInfo.id,r,t.checked).subscribe(a=>{if(this.loadingState=!1,a.status===1){if(r.isAllow=a?.data?.allow,r.isAllow){this.aclAllow.push(r),this.aclAllow=[...this.aclAllow];let m=this.aclDeny.indexOf(r);this.aclDeny.splice(m,1),this.aclDeny=[...this.aclDeny]}else{this.aclDeny.push(r),this.aclDeny=[...this.aclDeny];let m=this.aclAllow.indexOf(r);this.aclAllow.splice(m,1),this.aclAllow=[...this.aclAllow]}this.openSnackBar(this.translateService.instant("admin.system.role.notify.updateSuccess"),"");return}this.openSnackBar(this.translateService.instant("admin.system.role.notify.updateFailed"),"")})}changeTab(t){switch(t.index){case 0:this.tabCurrent="permission-tab-role-info";break;case 1:this.tabCurrent="permission-tab-all-routes";break;case 2:this.tabCurrent="permission-tab-allowed-routes";break;case 3:this.tabCurrent="permission-tab-denied-routes";break;default:break}}static \u0275fac=function(r){return new(r||e)(v(Ne),v(q),v(Ue),v(J),v(Z),v(L),v(le),v(Ce),v(Me),v(vt),v(xe),v(pe))};static \u0275cmp=F({type:e,selectors:[["app-dialog-permission-role"]],viewQuery:function(r,a){if(r&1&&Ie(Ya,5),r&2){let m;De(m=Ae())&&(a.keyword=m.first)}},features:[O],decls:34,vars:26,consts:[["profileRole",""],["routeAll",""],["routeAllowed",""],["routeDeny",""],["keyword",""],["mat-dialog-title",""],["mat-stretch-tabs","false","mat-align-tabs","start","animationDuration","0ms",3,"selectedTabChange"],[3,"label"],[1,"f-s-14","p-16","rounded","m-t-12"],[4,"ngTemplateOutlet"],["align","end",1,"p-r-30","p-b-30"],["mat-stroked-button","","color","warn","mat-dialog-close",""],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"disabled","click",4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-sm-12"],[1,"f-w-600","d-block","m-b-10"],["appearance","outline",1,"w-100"],["type","text","formControlName","name","matInput","",3,"placeholder"],[4,"ngIf"],[1,"row","m-b-20"],["appearance","outline",1,"d-flex","input-height-46","w-100"],[3,"selectionChange","value"],[3,"value",4,"ngFor","ngForOf"],["class","m-b-0",4,"ngIf"],[1,"m-b-0"],[3,"value"],[1,"col-sm-12","p-l-0"],[1,"m-b-15","d-lg-flex","align-items-center"],["appearance","outline",1,"theme-select","m-r-10","d-flex","input-height-40"],["matInput","","type","text",3,"keydown.enter","placeholder"],["mat-flat-button","",1,"bg-primary","text-white","btn-height-40",3,"click"],["name","search",1,"icon-20","m-r-10"],[1,"row","table-responsive"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","sequence"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14 fixed-width-column",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",3,"width",4,"matCellDef"],["matColumnDef","allowed"],["matColumnDef","name"],["mat-cell","","class","mat-body-1",4,"matCellDef"],["matColumnDef","groupName"],["matColumnDef","package"],["matColumnDef","uri"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","text-center p-2",4,"ngIf"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14","fixed-width-column"],["mat-cell","",1,"mat-body-1"],[1,"f-s-15","f-w-700","m-t-4","m-b-0"],["color","primary",3,"change","checked"],[1,"f-w-600"],[1,"text-muted","font-size-base"],["mat-header-row",""],["mat-row",""],[1,"text-center","p-2"],[1,"text-muted"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click","disabled"]],template:function(r,a){if(r&1){let m=R();o(0,"h2",5),s(1),p(2,"translate"),l(),o(3,"mat-dialog-content")(4,"mat-tab-group",6),b("selectedTabChange",function(y){return D(m),A(a.changeTab(y))}),o(5,"mat-tab",7),p(6,"translate"),o(7,"div",8),_(8,er,1,0,null,9),l()(),o(9,"mat-tab",7),p(10,"translate"),o(11,"div",8),_(12,ir,1,0,null,9),l()(),o(13,"mat-tab",7),p(14,"translate"),o(15,"div",8),_(16,ar,1,0,null,9),l()(),o(17,"mat-tab",7),p(18,"translate"),o(19,"div",8),_(20,or,1,0,null,9),l()()(),_(21,gr,26,18,"ng-template",null,0,ie)(23,Pr,35,14,"ng-template",null,1,ie)(25,Kr,23,4,"ng-template",null,2,ie)(27,po,23,4,"ng-template",null,3,ie),l(),o(29,"mat-dialog-actions",10)(30,"button",11),s(31),p(32,"translate"),l(),_(33,co,3,4,"button",12),l()}if(r&2){let m=V(22),u=V(24),y=V(26),I=V(28);n(),h(se(2,11,"admin.system.permission.titleForRole",me(24,Za,a.roleInfo.name))),n(4),E("label",d(6,14,"admin.system.role.profile")),n(3),c("ngTemplateOutlet",m),n(),E("label",d(10,16,"admin.system.role.allRoute")),n(3),c("ngTemplateOutlet",u),n(),E("label",d(14,18,"admin.system.role.allowedRoute")),n(3),c("ngTemplateOutlet",y),n(),E("label",d(18,20,"admin.system.role.deniedRoute")),n(3),c("ngTemplateOutlet",I),n(11),h(d(32,22,"buttons.close")),n(2),c("ngIf",a.tabCurrent==="permission-tab-role-info")}},dependencies:[$,H,Dt,Te,z,G,Re,ke,Pe,ae,Q,K,W,Be,Rt,Tt,Ut,de,ue,he,_e,ce,ye,fe,ge,ve,Se,re,ne,Ve,je,Le,Fe,oe,Y],styles:[".admin-dialog-role-permission .mat-mdc-tab-body-content{overflow:hidden!important}  .admin-dialog-role-permission .mat-mdc-form-field-error-wrapper{padding:0}  .admin-dialog-role-permission .mdc-button__label{display:flex;align-items:center}"]})};var uo=()=>["/"],_o=e=>({count:e}),fo=(e,i)=>({"bg-error":e,"bg-success":i});function go(e,i){if(e&1&&(o(0,"mat-option",18),S(1),s(2),p(3,"translate"),x(),l()),e&2){let t=i.$implicit;c("value",t),n(2),f(" ",d(3,2,"admin.system.role.status."+t)," ")}}function ho(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function yo(e,i){if(e&1&&(o(0,"td",39)(1,"p",40),s(2),l()()),e&2){let t=i.index,r=g();w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function vo(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.name")," "))}function So(e,i){if(e&1){let t=R();o(0,"a",43),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.openDialogPermission(a))}),o(1,"span",44),s(2),l()()}if(e&2){let t=g().$implicit;n(2),h(t.name)}}function xo(e,i){if(e&1&&(o(0,"span",45),s(1),l()),e&2){let t=g().$implicit;n(),h(t.name)}}function Co(e,i){if(e&1&&(o(0,"td",41),_(1,So,3,1,"a",42)(2,xo,2,1,"ng-template",null,0,ie),l()),e&2){let t=i.$implicit,r=V(3);n(),c("ngIf",t.permissionLocked===0)("ngIfElse",r)}}function bo(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.role.status")," "))}function wo(e,i){if(e&1&&(o(0,"td",39)(1,"div")(2,"span",46),s(3),p(4,"translate"),l()()()),e&2){let t=i.$implicit;w("width",300,"px"),n(2),c("ngClass",li(6,fo,t.status===0,t.status===1)),n(),f(" ",d(4,4,"admin.system.role.status."+t.status)," ")}}function Io(e,i){e&1&&C(0,"th",38)}function Do(e,i){if(e&1){let t=R();S(0),o(1,"button",49),C(2,"i-tabler",50),l(),o(3,"mat-menu",51,1)(5,"button",52),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.openDialogPermission(a))}),o(6,"mat-icon"),C(7,"i-tabler",53),l(),o(8,"span"),s(9),p(10,"translate"),l()()(),x()}if(e&2){let t=V(4);n(),c("matMenuTriggerFor",t),n(8),h(d(10,2,"admin.system.role.permission"))}}function Ao(e,i){if(e&1&&(o(0,"td",47),_(1,Do,11,4,"ng-container",48),l()),e&2){let t=i.$implicit;w("width",50,"px"),n(),c("ngIf",t.permissionLocked==0)}}function Eo(e,i){e&1&&C(0,"tr",54)}function Ro(e,i){e&1&&C(0,"tr",55)}function To(e,i){e&1&&C(0,"mat-divider",56)}var Wt=class e extends X{constructor(t,r,a,m,u,y,I){super(t,r,a,m);this.activeRoute=t;this.translateService=r;this.authenticationService=a;this.injector=m;this.roleService=u;this.dialog=y;this.location=I;this.activeRoute.queryParams.subscribe(P=>{this.currentPage=P.page??1,this.currentPage=parseInt(this.currentPage.toString()),this.pageIndex=this.currentPage-1,this.status=P.hasOwnProperty("status")?parseInt(P.status):-1,this.keyword=P.keyword??""})}roles=[];statuses=[1,0];keyword="";status;environment=k;filterCount=0;displayedColumns=["sequence","name","status","action"];listPermissionLocked=[1,0];ngOnInit(){this.search()}search(){this.loadingState=!0;let t={limit:this.pageSize};this.pageIndex>0&&(t.page=this.pageIndex),this.keyword!==""&&(t.keyword=encodeURIComponent(this.keyword)),typeof this.status<"u"&&this.status!==-1&&(t.status=this.status),this.roleService.get(t).subscribe(a=>{this.roles=a.data.length>0?a.data:[],this.loadingState=!1,this.filterCount=a.count||0,this.pageLength=a.count});let r=[];for(let a in t)r.push(a+"="+t[a]);this.location.replaceState(`/${k.administratorPrefix}/system/manage-role`,r.join("&"))}openDialogCreateRole(){this.dialog.open(zt,{autoFocus:!0,width:"400px",height:"auto",panelClass:"admin-dialog-role-create",data:{statuses:this.statuses,listPermissionLocked:this.listPermissionLocked}}).afterClosed().subscribe(r=>{r&&this.search()})}onInputKeyword(t){let r=t.target.value;this.keyword=r,this.pageIndex=0,this.currentPage=1,this.search()}onSelectStatusChange(t){this.status=t.value,this.search()}onPageChange(t){this.loadingState||this.pageSize===t.pageSize&&this.pageIndex===t.pageIndex||(this.pageIndex=t.pageIndex,this.currentPage=t.pageIndex+1,this.pageSize=t.pageSize,this.search())}openDialogPermission(t){this.dialog.open(Gt,{autoFocus:!1,panelClass:"admin-dialog-role-permission",width:"1200px",height:"auto",maxHeight:"80vh",data:{role:t,statuses:this.statuses}}).afterClosed().subscribe(a=>{a&&this.search()})}static \u0275fac=function(r){return new(r||e)(v(q),v(J),v(Z),v(L),v(le),v(Ce),v(pe))};static \u0275cmp=F({type:e,selectors:[["app-admin-system-role"]],features:[O],decls:61,vars:47,consts:[["superAdmin",""],["menu","matMenu"],[1,"bg-white","rounded","p-20","m-b-30"],[1,"row"],[1,"col-sm-8"],[1,"page-title","m-0","f-s-18","f-w-600"],[1,"col-sm-4","text-right"],[1,"d-flex","align-items-center","justify-content-start","justify-content-lg-end"],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"text-body-color",3,"routerLink"],["name","circle-filled",1,"icon-8"],[1,"cardWithShadow","widget-container"],[1,"p-t-0"],[1,"p-t-0","p-b-20","d-lg-flex"],["appearance","outline",1,"theme-select","m-r-10","d-flex","m-t-20","input-height-46"],["type","text","matInput","",3,"keyup.enter","ngModelChange","placeholder","ngModel"],[3,"selectionChange","value"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"m-r-10","p-t-12","m-t-24",3,"innerHTML"],["mat-mini-fab","","color","primary m-t-24",1,"d-flex",3,"click"],["data-icon","solar:refresh-bold",1,"iconify","icon-20","d-flex"],["mat-flat-button","","color","primary m-t-20 m-l-auto btn-height-46",1,"d-flex","align-items-center",3,"click"],[1,"table-responsive"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","sequence"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14 fixed-width-column",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",3,"width",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","class","mat-body-1 text-hover-primary",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","action"],["mat-cell","","class","text-center mat-body-1",3,"width",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","m-b-10",4,"ngIf"],["aria-label","Select page",3,"page","length","pageIndex","pageSize","pageSizeOptions"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14","fixed-width-column"],["mat-cell","",1,"mat-body-1"],[1,"f-s-15","f-w-700","m-t-4","m-b-0"],["mat-cell","",1,"mat-body-1","text-hover-primary"],["class","cursor-pointer",3,"click",4,"ngIf","ngIfElse"],[1,"cursor-pointer",3,"click"],[1,"hover-text"],[1,"text-error"],[1,"rounded","f-w-600","p-6","p-y-4","f-s-12","m-t-8","text-white",3,"ngClass"],["mat-cell","",1,"text-center","mat-body-1"],[4,"ngIf"],["mat-icon-button","","aria-label","action",3,"matMenuTriggerFor"],["name","dots-vertical"],[1,"cardWithShadow"],["mat-menu-item","",3,"click"],["name","shield-cog"],["mat-header-row",""],["mat-row",""],[1,"m-b-10"]],template:function(r,a){r&1&&(o(0,"div",2)(1,"div",3)(2,"div",4)(3,"h4",5),s(4),p(5,"translate"),l()(),o(6,"div",6)(7,"div",7)(8,"ul",8)(9,"li",9)(10,"a",10),s(11),p(12,"translate"),l()(),o(13,"li",9),C(14,"i-tabler",11),l()()()()()(),o(15,"mat-card",12)(16,"mat-card-content",13)(17,"div",14)(18,"mat-form-field",15)(19,"mat-label"),s(20),p(21,"translate"),l(),o(22,"input",16),p(23,"translate"),b("keyup.enter",function(u){return a.onInputKeyword(u)}),Qe("ngModelChange",function(u){return Ke(a.keyword,u)||(a.keyword=u),u}),l()(),o(24,"mat-form-field",15)(25,"mat-label"),s(26),p(27,"translate"),l(),o(28,"mat-select",17),b("selectionChange",function(u){return a.onSelectStatusChange(u)}),o(29,"mat-option",18),s(30),p(31,"translate"),l(),_(32,go,4,4,"mat-option",19),l()(),C(33,"div",20),p(34,"number"),p(35,"translate"),o(36,"button",21),b("click",function(){return a.search()}),C(37,"i",22),l(),o(38,"button",23),b("click",function(){return a.openDialogCreateRole()}),o(39,"span"),s(40),p(41,"translate"),l()()(),C(42,"mat-divider"),o(43,"div",24)(44,"table",25),S(45,26),_(46,ho,3,3,"th",27)(47,yo,3,3,"td",28),x(),S(48,29),_(49,vo,3,3,"th",27)(50,Co,4,2,"td",30),x(),S(51,31),_(52,bo,3,3,"th",27)(53,wo,5,9,"td",28),x(),S(54,32),_(55,Io,1,0,"th",27)(56,Ao,2,3,"td",33),x(),_(57,Eo,1,0,"tr",34)(58,Ro,1,0,"tr",35),l()(),_(59,To,1,0,"mat-divider",36),o(60,"mat-paginator",37),b("page",function(u){return a.onPageChange(u)}),l()()()),r&2&&(n(4),f(" ",d(5,25,"admin.system.role.title")," "),n(6),c("routerLink",Je(44,uo)),n(),h(d(12,27,"labels.dashboard")),n(7),w("width",300,"px"),n(2),h(d(21,29,"admin.system.role.keywordLabel")),n(2),E("placeholder",d(23,31,"admin.system.role.placeholder.enterKeyword")),We("ngModel",a.keyword),n(2),w("width",200,"px"),n(2),h(d(27,33,"admin.system.role.status")),n(2),c("value",a.status),n(),c("value",-1),n(),h(d(31,35,"labels.all")),n(2),c("ngForOf",a.statuses),n(),c("innerHTML",se(35,39,"admin.system.role.findCountRole",me(45,_o,d(34,37,a.filterCount))),Ge),n(7),h(d(41,42,"admin.system.role.createRole")),n(4),c("dataSource",a.roles),n(13),c("matHeaderRowDef",a.displayedColumns),n(),c("matRowDefColumns",a.displayedColumns),n(),c("ngIf",a.pageLength),n(),c("length",a.pageLength)("pageIndex",a.pageIndex)("pageSize",a.pageSize)("pageSizeOptions",a.pageSizeOptions))},dependencies:[Ye,$,H,z,G,it,Xe,ae,tt,et,Q,K,W,Et,nt,at,Pt,kt,Mt,de,ue,he,_e,ce,ye,fe,ge,ve,Se,re,ne,rt,ot,oe,Ze,Y]})};var Kt=class{id="";name="";route="";groupName="";uri="";vendor="";package="";controller="";methods=[];middleware=[];wheres=[];constructor(i){i&&(this.id=i.id||null,this.name=i.name||null,this.route=i.route||null,this.groupName=i.groupName||null,this.uri=i.uri||null,this.vendor=i.vendor||null,this.package=i.package||null,this.methods=i.methods||[],this.controller=i.controller||null,this.middleware=i.middleware||[],this.wheres=i.wheres||null)}};var Qt=class e{constructor(i,t){this.http=i;this.backendService=t}apiServerPaths=k.backendServer.paths;get(i){let t={params:{encryptParam:!0},headers:{Accept:"application/json"}};for(let r in i)t.params[r]=i[r];return this.backendService.get(this.apiServerPaths.administrator.route.list,t,B(r=>{let a=[],m=r.data.routes;if(m&&m.length)for(let u in m)a.push(new Kt(m[u]));return{data:a,count:r.data.count}}))}import(){let i={params:{encryptParam:!0},headers:{Accept:"application/json"}};return this.backendService.get(this.apiServerPaths.administrator.route.import,i,B(t=>t))}update(i,t){let r=t;r.encryptBody=!0;let a=this.apiServerPaths.administrator.route.update.replace("{ROUTE_ID}",i.toString());return this.backendService.post(a,r,B(m=>m))}updateRoute(i){let t={id:i.id,route:i.route};return this.backendService.post(this.apiServerPaths.administrator.route.update,t,B(r=>r))}static \u0275fac=function(t){return new(t||e)(j(Ee),j(Oe))};static \u0275prov=te({token:e,factory:e.\u0275fac,providedIn:"root"})};var Po=["inlineEditControlName"],Mo=["inlineEditControlRoute"],Bo=["inlineEditControlGroupName"],Uo=()=>["/"],No=e=>({count:e}),Vo=(e,i,t,r)=>({"bg-error":e,"bg-success":i,"bg-warning":t,"bg-primary":r});function jo(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"labels.sequence")," "))}function Fo(e,i){if(e&1&&(o(0,"td",39)(1,"p",40),s(2),l()()),e&2){let t=i.index,r=g();w("width",75,"px"),n(2),h(t+1+r.pageIndex*r.pageSize)}}function Lo(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.name")," "))}function Oo(e,i){if(e&1){let t=R();o(0,"span",44),p(1,"translate"),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.editValue(a.name,a,m.typeObjects.name))})("focus",function(){D(t);let a=g().$implicit,m=g();return A(m.editValue(a.name,a,m.typeObjects.name))}),s(2),l()}if(e&2){let t=g().$implicit;E("matTooltip",d(1,2,"buttons.clickToEdit")),n(2),f("",t.name," ")}}function $o(e,i){if(e&1){let t=R();o(0,"div",45)(1,"mat-form-field",46)(2,"input",47,0),p(4,"translate"),b("keypress",function(a){D(t);let m=g().$implicit,u=g();return A(u.onKeyPressInput(a,m,u.typeObjects.name))}),l(),o(5,"button",48),b("click",function(){D(t);let a=g(2);return A(a.editNameId="")}),C(6,"i-tabler",49),l(),o(7,"button",50),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.saveValue(a,m.typeObjects.name))}),C(8,"i-tabler",51),l()()()}if(e&2){let t=V(3),r=g().$implicit,a=g();n(2),E("placeholder",d(4,5,"admin.system.route.placeholder.enterRouteName")),c("required",a.required)("value",r.name)("type","text"),n(5),c("disabled",!t.value)}}function Ho(e,i){if(e&1&&(o(0,"td",41),_(1,Oo,3,4,"span",42)(2,$o,9,7,"div",43),l()),e&2){let t=i.$implicit,r=g();n(),c("ngIf",r.editNameId!==t.id),n(),c("ngIf",r.editNameId===t.id)}}function qo(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.groupName")," "))}function zo(e,i){if(e&1){let t=R();o(0,"span",44),p(1,"translate"),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.editValue(a.groupName,a,m.typeObjects.groupName))})("focus",function(){D(t);let a=g().$implicit,m=g();return A(m.editValue(a.groupName,a,m.typeObjects.groupName))}),s(2),l()}if(e&2){let t=g().$implicit;E("matTooltip",d(1,2,"buttons.clickToEdit")),n(2),f("",t.groupName||"N/A"," ")}}function Go(e,i){if(e&1){let t=R();o(0,"div",45)(1,"mat-form-field",46)(2,"input",47,1),p(4,"translate"),b("keypress",function(a){D(t);let m=g().$implicit,u=g();return A(u.onKeyPressInput(a,m,u.typeObjects.groupName))}),l(),o(5,"button",52),b("click",function(){D(t);let a=g(2);return A(a.editGroupNameId="")}),C(6,"i-tabler",49),l(),o(7,"button",50),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.saveValue(a,m.typeObjects.groupName))}),C(8,"i-tabler",51),l()()()}if(e&2){let t=V(3),r=g().$implicit,a=g();n(2),E("placeholder",d(4,5,"admin.system.route.placeholder.enterGroupName")),c("required",a.required)("value",r.groupName)("type","text"),n(5),c("disabled",!t.value)}}function Wo(e,i){if(e&1&&(o(0,"td",41),_(1,zo,3,4,"span",42)(2,Go,9,7,"div",43),l()),e&2){let t=i.$implicit,r=g();w("width",400,"px"),n(),c("ngIf",r.editGroupNameId!==t.id),n(),c("ngIf",r.editGroupNameId===t.id)}}function Ko(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.route")," "))}function Qo(e,i){if(e&1){let t=R();o(0,"span",44),p(1,"translate"),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.editValue(a.route,a,m.typeObjects.route))})("focus",function(){D(t);let a=g().$implicit,m=g();return A(m.editValue(a.route,a,m.typeObjects.route))}),s(2),l()}if(e&2){let t=g().$implicit;E("matTooltip",d(1,2,"buttons.clickToEdit")),n(2),f("",t.route," ")}}function Jo(e,i){if(e&1){let t=R();o(0,"div",45)(1,"mat-form-field",46)(2,"input",47,2),p(4,"translate"),b("keypress",function(a){D(t);let m=g().$implicit,u=g();return A(u.onKeyPressInput(a,m,u.typeObjects.route))}),l(),o(5,"button",53),b("click",function(){D(t);let a=g(2);return A(a.editRouteId="")}),C(6,"i-tabler",49),l(),o(7,"button",54),b("click",function(){D(t);let a=g().$implicit,m=g();return A(m.saveValue(a,m.typeObjects.route))}),C(8,"i-tabler",51),l()()()}if(e&2){let t=V(3),r=g().$implicit,a=g();n(2),E("placeholder",d(4,5,"admin.system.route.placeholder.enterRoute")),c("required",a.required)("value",r.route)("type","text"),n(5),c("disabled",!t.value)}}function Yo(e,i){if(e&1&&(o(0,"td",41),_(1,Qo,3,4,"span",42)(2,Jo,9,7,"div",43),l()),e&2){let t=i.$implicit,r=g();w("width",450,"px"),n(),c("ngIf",r.editRouteId!==t.id),n(),c("ngIf",r.editRouteId===t.id)}}function Zo(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.uri")," "))}function Xo(e,i){if(e&1&&(o(0,"td",39),s(1),l()),e&2){let t=i.$implicit;w("width",300,"px"),n(),f(" ",t.uri," ")}}function el(e,i){e&1&&(o(0,"th",38),s(1),p(2,"translate"),l()),e&2&&(n(),f(" ",d(2,1,"admin.system.route.method")," "))}function tl(e,i){if(e&1&&(S(0),o(1,"span",56),s(2),l(),x()),e&2){let t=i.$implicit;n(),c("ngClass",si(2,Vo,t==="DELETE",t==="POST",t==="PUT",t==="GET")),n(),f(" ",t," ")}}function il(e,i){if(e&1&&(o(0,"td",39),_(1,tl,3,7,"ng-container",55),l()),e&2){let t=i.$implicit;w("width",100,"px"),n(),c("ngForOf",t.methods)}}function nl(e,i){e&1&&C(0,"tr",57)}function al(e,i){e&1&&C(0,"tr",58)}function rl(e,i){e&1&&C(0,"mat-divider",59)}var Jt=class e extends X{constructor(t,r,a,m,u,y,I,P){super(t,r,a,m);this.activeRoute=t;this.translateService=r;this.authenticationService=a;this.injector=m;this.roleService=u;this.dialog=y;this.routeService=I;this.location=P;this.activeRoute.queryParams.subscribe(U=>{this.currentPage=U.page??1,this.currentPage=parseInt(this.currentPage.toString()),this.pageIndex=this.currentPage-1,this.keyword=U.keyword??""})}keyword="";routes=[];filterCount=0;environment=k;required=!1;type="text";inlineEditControlName;editNameId="";preNameValue="";inlineEditControlRoute;editRouteId="";preRouteValue="";inlineEditControlGroupName;editGroupNameId="";preGroupNameValue="";onDestroyRoute;displayedColumns=["sequence","name","groupName","route","uri","method"];typeObjects={name:1,groupName:2,route:3};ngOnInit(){this.search()}onInputKeyword(t){let r=t.target.value;this.keyword=r,this.pageIndex=0,this.currentPage=1,this.search()}search(){let t={};this.pageIndex>0&&(t.page=this.pageIndex),this.pageSize>0&&(t.limit=this.pageSize),this.keyword!==""&&(t.keyword=encodeURIComponent(this.keyword)),this.onDestroyRoute=this.routeService.get(t).subscribe(a=>{this.routes=a.data||[],this.filterCount=a.count,this.pageLength=a.count});let r=[];for(let a in t)r.push(a+"="+t[a]);this.location.replaceState(`/${k.administratorPrefix}/system/manage-route`,r.join("&"))}onPageChange(t){this.loadingState||this.pageSize===t.pageSize&&this.pageIndex===t.pageIndex||(this.pageIndex=t.pageIndex,this.currentPage=t.pageIndex+1,this.pageSize=t.pageSize,this.search())}syncRoute(){this.routeService.import().subscribe(t=>{this.search()})}openDialogSyncRoute(){let t=this.dialog.open(bi,{width:"400px",disableClose:!1,data:{callback:()=>{this.syncRoute()}}})}onKeyPressInput(t,r,a){if(t.key==="Enter"&&t.target.value!==""){let m=0;switch(a){case this.typeObjects.name:m=this.typeObjects.name;break;case this.typeObjects.groupName:m=this.typeObjects.groupName;break;case this.typeObjects.route:m=this.typeObjects.route;break;default:break}this.saveValue(r,m)}}editValue(t,r,a){switch(a){case this.typeObjects.name:this.preNameValue=t,this.editNameId=r.id,setTimeout(()=>{this.inlineEditControlName.nativeElement.focus()});break;case this.typeObjects.groupName:this.preGroupNameValue=t,this.editGroupNameId=r.id,setTimeout(()=>{this.inlineEditControlGroupName.nativeElement.focus()});break;case this.typeObjects.route:this.preRouteValue=t,this.editRouteId=r.id,setTimeout(()=>{this.inlineEditControlRoute.nativeElement.focus()});break;default:break}}saveValue(t,r){if(t==null)return;let a="",m="",u="",y={},I=t.id;switch(r){case this.typeObjects.name:m=this.inlineEditControlName.nativeElement.value;let P=this.routes.findIndex(M=>M.id===I);this.editNameId="",this.routes[P].name=m,y={name:m};break;case this.typeObjects.groupName:u=this.inlineEditControlGroupName.nativeElement.value;let U=this.routes.findIndex(M=>M.id===I);this.editGroupNameId="",this.routes[U].groupName=u,y={groupName:u};break;case this.typeObjects.route:a=this.inlineEditControlRoute.nativeElement.value,this.editRouteId="",y={route:a};break;default:break}this.routeService.update(I,y).subscribe(P=>{let U=this.routes.findIndex(M=>M.id===I);if(typeof U<"u")switch(r){case this.typeObjects.name:this.routes[U].name=m;break;case this.typeObjects.groupName:this.routes[U].groupName=u;break;case this.typeObjects.route:this.routes[U].route=a;break;default:break}})}static \u0275fac=function(r){return new(r||e)(v(q),v(J),v(Z),v(L),v(le),v(Ce),v(Qt),v(pe))};static \u0275cmp=F({type:e,selectors:[["app-admin-system-route"]],viewQuery:function(r,a){if(r&1&&(Ie(Po,5),Ie(Mo,5),Ie(Bo,5)),r&2){let m;De(m=Ae())&&(a.inlineEditControlName=m.first),De(m=Ae())&&(a.inlineEditControlRoute=m.first),De(m=Ae())&&(a.inlineEditControlGroupName=m.first)}},hostBindings:function(r,a){r&1&&b("keypress",function(u){return a.onKeyPressInput(u)})},inputs:{required:"required",type:"type"},features:[O],decls:58,vars:36,consts:[["inlineEditControlName",""],["inlineEditControlGroupName",""],["inlineEditControlRoute",""],[1,"bg-white","rounded","p-20","m-b-30"],[1,"row"],[1,"col-sm-8"],[1,"page-title","m-0","f-s-18","f-w-600"],[1,"col-sm-4","text-right"],[1,"d-flex","align-items-center","justify-content-start","justify-content-lg-end"],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"text-body-color",3,"routerLink"],["name","circle-filled",1,"icon-8"],[1,"cardWithShadow","widget-container","router-container"],[1,"p-t-0"],[1,"p-t-0","p-b-20","d-lg-flex"],["appearance","outline",1,"theme-select","m-r-10","d-flex","m-t-20","input-height-46"],["type","text","matInput","",3,"keyup.enter","ngModelChange","placeholder","ngModel"],[1,"m-r-10","p-t-12","m-t-24",3,"innerHTML"],["mat-mini-fab","","color","primary m-t-24",1,"d-flex",3,"click"],["data-icon","solar:refresh-bold",1,"iconify","icon-20","d-flex"],["mat-flat-button","","color","primary m-t-20 m-l-auto btn-height-46",1,"d-flex","align-items-center",3,"click"],[1,"table-responsive"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","sequence"],["mat-header-cell","","class","f-w-600 mat-subtitle-1 f-s-14 fixed-width-column",4,"matHeaderCellDef"],["mat-cell","","class","mat-body-1",3,"width",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","class","mat-body-1 text-hover-primary",4,"matCellDef"],["matColumnDef","groupName"],["mat-cell","","class","mat-body-1 text-hover-primary",3,"width",4,"matCellDef"],["matColumnDef","route"],["matColumnDef","uri"],["matColumnDef","method"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","m-b-10",4,"ngIf"],["aria-label","Select page",3,"page","length","pageIndex","pageSize","pageSizeOptions"],["mat-header-cell","",1,"f-w-600","mat-subtitle-1","f-s-14","fixed-width-column"],["mat-cell","",1,"mat-body-1"],[1,"f-s-15","f-w-700","m-t-4","m-b-0"],["mat-cell","",1,"mat-body-1","text-hover-primary"],["class","hover-text cursor-pointer","matTooltipPosition","above",3,"matTooltip","click","focus",4,"ngIf"],["class","d-flex",4,"ngIf"],["matTooltipPosition","above",1,"hover-text","cursor-pointer",3,"click","focus","matTooltip"],[1,"d-flex"],["appearance","outline",1,"theme-select","m-r-10","d-flex","input-height-40",2,"width","350px"],["matInput","",3,"keypress","required","value","type","placeholder"],["mat-flat-button","","matSuffix","",1,"bg-error","text-white","btn-width-40","btn-height-40","r-r-0","r-l-0","cancel-action-btn",3,"click"],["name","x"],["mat-flat-button","","matSuffix","",1,"bg-success","text-white","btn-height-40","r-l-0",3,"click","disabled"],["name","check"],["mat-flat-button","","matSuffix","",1,"bg-error","text-white","btn-height-40","cancel-action-btn","r-l-0","r-r-0",3,"click"],["matSuffix","","mat-flat-button","",1,"bg-error","cancel-action-btn","text-white","btn-height-40","r-l-0","r-r-0",3,"click"],["matSuffix","","mat-flat-button","",1,"bg-success","text-white","btn-height-40","r-l-0",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"rounded","text-white","f-w-600","p-6","p-y-4","f-s-12","m-t-8",3,"ngClass"],["mat-header-row",""],["mat-row",""],[1,"m-b-10"]],template:function(r,a){r&1&&(o(0,"div",3)(1,"div",4)(2,"div",5)(3,"h4",6),s(4),p(5,"translate"),l()(),o(6,"div",7)(7,"div",8)(8,"ul",9)(9,"li",10)(10,"a",11),s(11),p(12,"translate"),l()(),o(13,"li",10),C(14,"i-tabler",12),l()()()()()(),o(15,"mat-card",13)(16,"mat-card-content",14)(17,"div",15)(18,"mat-form-field",16)(19,"mat-label"),s(20),p(21,"translate"),l(),o(22,"input",17),p(23,"translate"),b("keyup.enter",function(u){return a.onInputKeyword(u)}),Qe("ngModelChange",function(u){return Ke(a.keyword,u)||(a.keyword=u),u}),l()(),C(24,"div",18),p(25,"number"),p(26,"translate"),o(27,"button",19),b("click",function(){return a.search()}),C(28,"i",20),l(),o(29,"button",21),b("click",function(){return a.openDialogSyncRoute()}),o(30,"span"),s(31),p(32,"translate"),l()()(),C(33,"mat-divider"),o(34,"div",22)(35,"table",23),S(36,24),_(37,jo,3,3,"th",25)(38,Fo,3,3,"td",26),x(),S(39,27),_(40,Lo,3,3,"th",25)(41,Ho,3,2,"td",28),x(),S(42,29),_(43,qo,3,3,"th",25)(44,Wo,3,4,"td",30),x(),S(45,31),_(46,Ko,3,3,"th",25)(47,Yo,3,4,"td",30),x(),S(48,32),_(49,Zo,3,3,"th",25)(50,Xo,2,3,"td",26),x(),S(51,33),_(52,el,3,3,"th",25)(53,il,2,3,"td",26),x(),_(54,nl,1,0,"tr",34)(55,al,1,0,"tr",35),l()(),_(56,rl,1,0,"mat-divider",36),o(57,"mat-paginator",37),b("page",function(u){return a.onPageChange(u)}),l()()()),r&2&&(n(4),f(" ",d(5,18,"admin.system.route.title")," "),n(6),c("routerLink",Je(33,Uo)),n(),h(d(12,20,"labels.dashboard")),n(7),w("width",300,"px"),n(2),h(d(21,22,"admin.system.role.keywordLabel")),n(2),E("placeholder",d(23,24,"admin.system.role.placeholder.enterKeyword")),We("ngModel",a.keyword),n(2),c("innerHTML",se(26,28,"admin.system.route.findCountRoute",me(34,No,d(25,26,a.filterCount))),Ge),n(7),h(d(32,31,"admin.system.route.sync")),n(4),c("dataSource",a.routes),n(19),c("matHeaderRowDef",a.displayedColumns),n(),c("matRowDefColumns",a.displayedColumns),n(),c("ngIf",a.pageLength),n(),c("length",a.pageLength)("pageIndex",a.pageIndex)("pageSize",a.pageSize)("pageSizeOptions",a.pageSizeOptions))},dependencies:[Ye,$,H,z,G,it,Xe,ae,et,Q,K,W,At,nt,at,de,ue,he,_e,ce,ye,fe,ge,ve,Se,rt,Bt,ot,oe,Ze,Y],styles:[".router-container .mat-mdc-fab-base .mdc-button__label{display:flex;align-items:center}  .router-container .cancel-action-btn{min-width:35px;width:35px}@media (max-width: 1000px){  .router-container .mat-column-name{width:500px}}"]})};var ol=[{path:"system/manage-user",component:qt,data:{title:"admin.system.user.title"},canActivate:[Nt]},{path:"system/manage-role",component:Wt,data:{title:"admin.system.role.title"},canActivate:[Nt]},{path:"system/manage-route",component:Jt,data:{title:"admin.system.route.title"},canActivate:[Nt]}],Yt=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=It({type:e});static \u0275inj=wt({imports:[Xt.forChild(ol),Xt]})};var ai=class e{constructor(i){this._dateAdapter=i}selectionFinished(i){return this._createFiveDayRange(i)}createPreview(i){return this._createFiveDayRange(i)}_createFiveDayRange(i){if(i){let t=this._dateAdapter.addCalendarDays(i,-2),r=this._dateAdapter.addCalendarDays(i,2);return new ei(t,r)}return new ei(null,null)}static \u0275fac=function(t){return new(t||e)(j(ci))};static \u0275prov=te({token:e,factory:e.\u0275fac})},Ri=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=It({type:e});static \u0275inj=wt({providers:[ui(),{provide:gi,useClass:ai}],imports:[di,_i,fi,Yt,hi,wi,vi,yi,xi,Si,Ci.forRoot()]})};export{Ri as AdminModule,ai as FiveDayRangeSelectionStrategy};
